
<!doctype html>
<html lang="de" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Offizielle Dokumentation für ThemisDB (Architektur, Storage, Query/AQL, Sicherheit, APIs und Betrieb)">
      
      
      
        <link rel="canonical" href="https://example.local/themisdb/docs/aql_syntax/">
      
      
        <link rel="prev" href="../query_engine_aql/">
      
      
        <link rel="next" href="../aql_explain_profile/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>AQL Syntax - ThemisDB Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#aql-themis-query-language" class="md-skip">
          Zum Inhalt
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Kopfzeile">
    <a href=".." title="ThemisDB Docs" class="md-header__button md-logo" aria-label="ThemisDB Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ThemisDB Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AQL Syntax
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Suche" placeholder="Suche" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Suche">
        
        <button type="reset" class="md-search__icon md-icon" title="Zurücksetzen" aria-label="Zurücksetzen" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Suche wird initialisiert
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/makr-code/ThemisDB" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    makr-code/ThemisDB
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Hauptnavigation" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Übersicht

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../architecture/" class="md-tabs__link">
        
  
  
    
  
  Architektur

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../base_entity/" class="md-tabs__link">
          
  
  
  Basismodell

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../storage/geo_relational_schema/" class="md-tabs__link">
          
  
  
  Storage & MVCC

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../indexes/" class="md-tabs__link">
          
  
  
  Indexe & Statistiken

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../query_engine_aql/" class="md-tabs__link">
          
  
  
  Query & AQL

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../content_pipeline/" class="md-tabs__link">
          
  
  
  Content Pipeline

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../search/hybrid_search_design/" class="md-tabs__link">
          
  
  
  Suche

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../performance_benchmarks/" class="md-tabs__link">
          
  
  
  Performance & Benchmarks

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../quality_assurance/" class="md-tabs__link">
        
  
  
    
  
  Qualitätssicherung

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../vector_ops/" class="md-tabs__link">
          
  
  
  Vektor & GNN

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../security/overview/" class="md-tabs__link">
          
  
  
  Sicherheit & Governance

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../deployment/" class="md-tabs__link">
          
  
  
  Deployment & Betrieb

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../publishing/" class="md-tabs__link">
        
  
  
    
  
  Publikation & Ablage

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../admin_tools_admin_guide/" class="md-tabs__link">
          
  
  
  Admin-Tools

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../apis/openapi/" class="md-tabs__link">
          
  
  
  APIs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../styleguide/" class="md-tabs__link">
          
  
  
  Styleguide & Glossar

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../roadmap/" class="md-tabs__link">
        
  
  
    
  
  Roadmap

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../print_page/" class="md-tabs__link">
        
  
  
    
  
  Gesamte Dokumentation (Druckansicht)

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ThemisDB Docs" class="md-nav__button md-logo" aria-label="ThemisDB Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ThemisDB Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/makr-code/ThemisDB" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    makr-code/ThemisDB
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Übersicht
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architektur
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basismodell
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Basismodell
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base_entity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Entity & Keys
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../path_constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pfad-Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../property_graph_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Property Graph Modell
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Storage & MVCC
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Storage & MVCC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage/geo_relational_schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Storage-Layout (Geo/Relational)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage/rocksdb_layout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RocksDB Storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mvcc_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MVCC-Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transactions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transaktionen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time_series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time-Series Überblick
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory_tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Tuning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Indexe & Statistiken
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Indexe & Statistiken
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../indexes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Indexe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index_stats_maintenance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index-Statistiken & Wartung
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cursor_pagination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cursor/Pagination
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Query & AQL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Query & AQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../query_engine_aql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query Engine & AQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    AQL Syntax
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    AQL Syntax
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#uberblick" class="md-nav__link">
    <span class="md-ellipsis">
      Überblick
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syntax-ubersicht" class="md-nav__link">
    <span class="md-ellipsis">
      Syntax-Übersicht
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Syntax-Übersicht">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grundstruktur" class="md-nav__link">
    <span class="md-ellipsis">
      Grundstruktur
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mvp-einschrankungen-und-hinweise" class="md-nav__link">
    <span class="md-ellipsis">
      MVP-Einschränkungen und Hinweise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kern-klauseln" class="md-nav__link">
    <span class="md-ellipsis">
      Kern-Klauseln
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kern-Klauseln">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-for-collection-iteration" class="md-nav__link">
    <span class="md-ellipsis">
      1. FOR - Collection Iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-filter-bedingungen" class="md-nav__link">
    <span class="md-ellipsis">
      2. FILTER - Bedingungen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-sort-sortierung" class="md-nav__link">
    <span class="md-ellipsis">
      3. SORT - Sortierung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-limit-pagination" class="md-nav__link">
    <span class="md-ellipsis">
      4. LIMIT - Pagination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-return-projektion" class="md-nav__link">
    <span class="md-ellipsis">
      5. RETURN - Projektion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#erweiterte-features-phase-11" class="md-nav__link">
    <span class="md-ellipsis">
      Erweiterte Features (Phase 1.1+)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Erweiterte Features (Phase 1.1+)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#let-variable-binding-mvp-seit-31102025" class="md-nav__link">
    <span class="md-ellipsis">
      LET - Variable Binding (MVP seit 31.10.2025)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collect-aggregationen-mvp-seit-31102025" class="md-nav__link">
    <span class="md-ellipsis">
      COLLECT - Aggregationen (MVP seit 31.10.2025)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-spezifische-parameter-fur-pagination" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP-spezifische Parameter für Pagination
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spezial-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Spezial-Queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spezial-Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-traversierung" class="md-nav__link">
    <span class="md-ellipsis">
      Graph-Traversierung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vektor-ahnlichkeitssuche" class="md-nav__link">
    <span class="md-ellipsis">
      Vektor-Ähnlichkeitssuche
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geo-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Geo-Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fulltext-suche" class="md-nav__link">
    <span class="md-ellipsis">
      Fulltext-Suche
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#einfache-joins-mvp" class="md-nav__link">
    <span class="md-ellipsis">
      Einfache Joins (MVP)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funktionen-operatoren" class="md-nav__link">
    <span class="md-ellipsis">
      Funktionen &amp; Operatoren
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Funktionen &amp; Operatoren">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string-funktionen" class="md-nav__link">
    <span class="md-ellipsis">
      String-Funktionen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numeric-funktionen" class="md-nav__link">
    <span class="md-ellipsis">
      Numeric-Funktionen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aggregations-in-collect" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregations (in COLLECT)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Type-Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beispiel-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Beispiel-Queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Beispiel-Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-einfache-filterung" class="md-nav__link">
    <span class="md-ellipsis">
      1. Einfache Filterung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-geo-proximity-search" class="md-nav__link">
    <span class="md-ellipsis">
      2. Geo-Proximity-Search
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-vektor-suche-mit-filter" class="md-nav__link">
    <span class="md-ellipsis">
      3. Vektor-Suche mit Filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-aggregationen" class="md-nav__link">
    <span class="md-ellipsis">
      4. Aggregationen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-graph-traversierung" class="md-nav__link">
    <span class="md-ellipsis">
      5. Graph-Traversierung
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-execution-optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      Query-Execution &amp; Optimizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Query-Execution &amp; Optimizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explain-plan" class="md-nav__link">
    <span class="md-ellipsis">
      Explain-Plan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index-hints-spater" class="md-nav__link">
    <span class="md-ellipsis">
      Index-Hints (später)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ast-struktur-internal" class="md-nav__link">
    <span class="md-ellipsis">
      AST-Struktur (Internal)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementierungs-phasen" class="md-nav__link">
    <span class="md-ellipsis">
      Implementierungs-Phasen
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementierungs-Phasen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-mvp-woche-1-2" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1 (MVP - Woche 1-2):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-woche-3-4" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2 (Woche 3-4):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-woche-5-6" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3 (Woche 5-6):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-spater" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 4 (später):
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-uberlegungen" class="md-nav__link">
    <span class="md-ellipsis">
      Performance-Überlegungen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kompatibilitat-erweiterungen" class="md-nav__link">
    <span class="md-ellipsis">
      Kompatibilität &amp; Erweiterungen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fehlerbehandlung" class="md-nav__link">
    <span class="md-ellipsis">
      Fehlerbehandlung
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenz-links" class="md-nav__link">
    <span class="md-ellipsis">
      Referenz-Links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vollstandige-beispiele-mvp-features" class="md-nav__link">
    <span class="md-ellipsis">
      Vollständige Beispiele (MVP Features)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vollständige Beispiele (MVP Features)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beispiel-1-user-city-join-mit-aggregation" class="md-nav__link">
    <span class="md-ellipsis">
      Beispiel 1: User-City-Join mit Aggregation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beispiel-2-sales-analyse-mit-let-und-aggregation" class="md-nav__link">
    <span class="md-ellipsis">
      Beispiel 2: Sales-Analyse mit LET und Aggregation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beispiel-3-top-10-stadte-nach-user-count" class="md-nav__link">
    <span class="md-ellipsis">
      Beispiel 3: Top-10 Städte nach User-Count
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-best-practices-mvp" class="md-nav__link">
    <span class="md-ellipsis">
      Performance-Best-Practices (MVP)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance-Best-Practices (MVP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-join-optimierung" class="md-nav__link">
    <span class="md-ellipsis">
      1. JOIN-Optimierung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-let-fur-wiederverwendung" class="md-nav__link">
    <span class="md-ellipsis">
      2. LET für Wiederverwendung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-filter-vor-collect" class="md-nav__link">
    <span class="md-ellipsis">
      3. FILTER vor COLLECT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-status-31102025" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation-Status (31.10.2025)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aql_explain_profile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Explain & Profile
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recursive_path_queries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rekursive Pfadabfragen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../temporal_graphs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Temporale Graphen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../temporal_time_range_queries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zeitbereichs-Abfragen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../semantic_cache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semantischer Cache
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Content Pipeline
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Content Pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Content Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content_architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architektur-Details
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content/ingestion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ingestion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ingestion/json_ingestion_spec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JSON Ingestion Spec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content/geo_processor_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Geo-Processor Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content/image_processor_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image-Processor Design
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Suche
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Suche
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search/hybrid_search_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hybrid Search Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search/pagination_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pagination Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Performance & Benchmarks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Performance & Benchmarks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Überblick & Tuning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compression_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kompression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search/pagination_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pagination Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quality_assurance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qualitätssicherung
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vektor & GNN
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Vektor & GNN
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vector_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vektor-Operationen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gnn_embeddings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GNN Embeddings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hnsw_persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HNSW Persistenz & Warmstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sicherheit & Governance
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Sicherheit & Governance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Überblick
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rbac_authorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RBAC & Authorization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/key_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schlüsselverwaltung
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encryption_strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Verschlüsselungsstrategie
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encryption_deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Verschlüsselungsdeployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../column_encryption/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spaltenverschlüsselung
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/pii_detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PII-Detection (Überblick)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pii_detection_engines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PII-Detection Engines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pii_engine_signing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PII Engine Signing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/audit_and_retention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Audit & Retention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/threat_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security_hardening_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Hardening Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security_audit_checklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Audit Checklist
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compliance_audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance Audit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compliance_governance_strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Governance-Strategie
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compliance_integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance-Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../governance_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Governance Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/security_compliance_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security/Compliance Review
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deployment & Betrieb
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Deployment & Betrieb
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tracing & Observability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../change_data_capture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Change Data Capture (CDC)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operations_runbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operations Runbook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Publikation & Ablage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Admin-Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Admin-Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_admin_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Admin Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_user_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_feature_matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_search_sort_filter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suche/Sortierung/Filter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_demo_script/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Demo-Script
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    APIs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apis/openapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAPI & Endpunkte
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apis/openapi.md#sse-streaming-changefeed" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SSE-Streaming (Changefeed)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Styleguide & Glossar
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            Styleguide & Glossar
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../styleguide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Styleguide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossar
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roadmap
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../print_page/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gesamte Dokumentation (Druckansicht)
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#uberblick" class="md-nav__link">
    <span class="md-ellipsis">
      Überblick
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syntax-ubersicht" class="md-nav__link">
    <span class="md-ellipsis">
      Syntax-Übersicht
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Syntax-Übersicht">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grundstruktur" class="md-nav__link">
    <span class="md-ellipsis">
      Grundstruktur
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mvp-einschrankungen-und-hinweise" class="md-nav__link">
    <span class="md-ellipsis">
      MVP-Einschränkungen und Hinweise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kern-klauseln" class="md-nav__link">
    <span class="md-ellipsis">
      Kern-Klauseln
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kern-Klauseln">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-for-collection-iteration" class="md-nav__link">
    <span class="md-ellipsis">
      1. FOR - Collection Iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-filter-bedingungen" class="md-nav__link">
    <span class="md-ellipsis">
      2. FILTER - Bedingungen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-sort-sortierung" class="md-nav__link">
    <span class="md-ellipsis">
      3. SORT - Sortierung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-limit-pagination" class="md-nav__link">
    <span class="md-ellipsis">
      4. LIMIT - Pagination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-return-projektion" class="md-nav__link">
    <span class="md-ellipsis">
      5. RETURN - Projektion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#erweiterte-features-phase-11" class="md-nav__link">
    <span class="md-ellipsis">
      Erweiterte Features (Phase 1.1+)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Erweiterte Features (Phase 1.1+)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#let-variable-binding-mvp-seit-31102025" class="md-nav__link">
    <span class="md-ellipsis">
      LET - Variable Binding (MVP seit 31.10.2025)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collect-aggregationen-mvp-seit-31102025" class="md-nav__link">
    <span class="md-ellipsis">
      COLLECT - Aggregationen (MVP seit 31.10.2025)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-spezifische-parameter-fur-pagination" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP-spezifische Parameter für Pagination
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spezial-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Spezial-Queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spezial-Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-traversierung" class="md-nav__link">
    <span class="md-ellipsis">
      Graph-Traversierung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vektor-ahnlichkeitssuche" class="md-nav__link">
    <span class="md-ellipsis">
      Vektor-Ähnlichkeitssuche
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geo-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Geo-Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fulltext-suche" class="md-nav__link">
    <span class="md-ellipsis">
      Fulltext-Suche
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#einfache-joins-mvp" class="md-nav__link">
    <span class="md-ellipsis">
      Einfache Joins (MVP)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funktionen-operatoren" class="md-nav__link">
    <span class="md-ellipsis">
      Funktionen &amp; Operatoren
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Funktionen &amp; Operatoren">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string-funktionen" class="md-nav__link">
    <span class="md-ellipsis">
      String-Funktionen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numeric-funktionen" class="md-nav__link">
    <span class="md-ellipsis">
      Numeric-Funktionen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aggregations-in-collect" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregations (in COLLECT)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Type-Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beispiel-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Beispiel-Queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Beispiel-Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-einfache-filterung" class="md-nav__link">
    <span class="md-ellipsis">
      1. Einfache Filterung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-geo-proximity-search" class="md-nav__link">
    <span class="md-ellipsis">
      2. Geo-Proximity-Search
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-vektor-suche-mit-filter" class="md-nav__link">
    <span class="md-ellipsis">
      3. Vektor-Suche mit Filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-aggregationen" class="md-nav__link">
    <span class="md-ellipsis">
      4. Aggregationen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-graph-traversierung" class="md-nav__link">
    <span class="md-ellipsis">
      5. Graph-Traversierung
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-execution-optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      Query-Execution &amp; Optimizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Query-Execution &amp; Optimizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explain-plan" class="md-nav__link">
    <span class="md-ellipsis">
      Explain-Plan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index-hints-spater" class="md-nav__link">
    <span class="md-ellipsis">
      Index-Hints (später)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ast-struktur-internal" class="md-nav__link">
    <span class="md-ellipsis">
      AST-Struktur (Internal)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementierungs-phasen" class="md-nav__link">
    <span class="md-ellipsis">
      Implementierungs-Phasen
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementierungs-Phasen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-mvp-woche-1-2" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1 (MVP - Woche 1-2):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-woche-3-4" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2 (Woche 3-4):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-woche-5-6" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3 (Woche 5-6):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-spater" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 4 (später):
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-uberlegungen" class="md-nav__link">
    <span class="md-ellipsis">
      Performance-Überlegungen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kompatibilitat-erweiterungen" class="md-nav__link">
    <span class="md-ellipsis">
      Kompatibilität &amp; Erweiterungen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fehlerbehandlung" class="md-nav__link">
    <span class="md-ellipsis">
      Fehlerbehandlung
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenz-links" class="md-nav__link">
    <span class="md-ellipsis">
      Referenz-Links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vollstandige-beispiele-mvp-features" class="md-nav__link">
    <span class="md-ellipsis">
      Vollständige Beispiele (MVP Features)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vollständige Beispiele (MVP Features)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beispiel-1-user-city-join-mit-aggregation" class="md-nav__link">
    <span class="md-ellipsis">
      Beispiel 1: User-City-Join mit Aggregation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beispiel-2-sales-analyse-mit-let-und-aggregation" class="md-nav__link">
    <span class="md-ellipsis">
      Beispiel 2: Sales-Analyse mit LET und Aggregation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beispiel-3-top-10-stadte-nach-user-count" class="md-nav__link">
    <span class="md-ellipsis">
      Beispiel 3: Top-10 Städte nach User-Count
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-best-practices-mvp" class="md-nav__link">
    <span class="md-ellipsis">
      Performance-Best-Practices (MVP)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance-Best-Practices (MVP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-join-optimierung" class="md-nav__link">
    <span class="md-ellipsis">
      1. JOIN-Optimierung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-let-fur-wiederverwendung" class="md-nav__link">
    <span class="md-ellipsis">
      2. LET für Wiederverwendung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-filter-vor-collect" class="md-nav__link">
    <span class="md-ellipsis">
      3. FILTER vor COLLECT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-status-31102025" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation-Status (31.10.2025)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="aql-themis-query-language">AQL - THEMIS Query Language<a class="headerlink" href="#aql-themis-query-language" title="Permanent link">&para;</a></h1>
<p><strong>Version:</strong> 1.0<br />
<strong>Datum:</strong> 30. Oktober 2025<br />
<strong>Inspiriert von:</strong> ArangoDB AQL, mit Fokus auf Multi-Modell-Queries</p>
<hr />
<h2 id="uberblick">Überblick<a class="headerlink" href="#uberblick" title="Permanent link">&para;</a></h2>
<p><strong>AQL (Advanced Query Language)</strong> ist eine deklarative SQL-ähnliche Sprache für THEMIS, optimiert für hybride Queries über relationale, Graph-, Vektor- und Dokument-Daten.</p>
<p><strong>Design-Prinzipien:</strong>
- ✅ <strong>Einfach:</strong> SQL-ähnliche Syntax für schnelle Adoption
- ✅ <strong>Mächtig:</strong> Multi-Modell-Support (Relational, Graph, Vector)
- ✅ <strong>Optimierbar:</strong> Automatische Index-Auswahl via Optimizer
- ✅ <strong>Erweiterbar:</strong> Schrittweise Erweiterung (Aggregationen, Joins, Subqueries)</p>
<hr />
<h2 id="syntax-ubersicht">Syntax-Übersicht<a class="headerlink" href="#syntax-ubersicht" title="Permanent link">&para;</a></h2>
<h3 id="grundstruktur">Grundstruktur<a class="headerlink" href="#grundstruktur" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR variable IN collection
  [LET var = expression [, ...]]
  [FILTER condition]
  [SORT expression [ASC|DESC] [, ...]]
  [LIMIT offset, count]
  [RETURN expression]
</code></pre>
<p><strong>Execution-Reihenfolge:</strong>
1. <code>FOR</code> - Iteration über Collection/Index
2. <code>FILTER</code> - Prädikat-Evaluation (mit Index-Nutzung)
3. <code>SORT</code> - Sortierung (mit Index-Nutzung wenn möglich)
4. <code>LIMIT</code> - Pagination/Offset
5. <code>RETURN</code> - Projektion (Felder/Objekte/Arrays)</p>
<hr />
<h2 id="mvp-einschrankungen-und-hinweise">MVP-Einschränkungen und Hinweise<a class="headerlink" href="#mvp-einschrankungen-und-hinweise" title="Permanent link">&para;</a></h2>
<p>Damit Erwartungen klar sind, hier die wichtigsten Begrenzungen des aktuellen MVP:</p>
<ul>
<li>Kein generisches OR im Translator. AND wird unterstützt; OR ist in Arbeit und wird später ergänzt.</li>
<li>Feld-zu-Feld Vergleiche (z. B. <code>u.city == o.city</code>) sind im Translator nicht allgemein erlaubt. Ein spezieller Join-Pfad erlaubt jedoch Gleichheits‑Joins über genau zwei FOR‑Klauseln (siehe Abschnitt „Einfache Joins (MVP)“).</li>
<li>LET in FILTER: Falls einfache LET‑Bindungen in FILTER vorkommen, werden diese vor der Übersetzung extrahiert („pre‑extracted“). Bei <code>explain: true</code> signalisiert der Plan dies mit <code>plan.let_pre_extracted = true</code>.</li>
<li>Subqueries, OR, komplexe Ausdrücke/Funktionen sind (noch) eingeschränkt und werden iterativ erweitert.</li>
</ul>
<h2 id="kern-klauseln">Kern-Klauseln<a class="headerlink" href="#kern-klauseln" title="Permanent link">&para;</a></h2>
<h3 id="1-for-collection-iteration">1. FOR - Collection Iteration<a class="headerlink" href="#1-for-collection-iteration" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR doc IN users
  RETURN doc

FOR u IN users
  FILTER u.age &gt; 18
  RETURN u.name
</code></pre>
<p><strong>Syntax:</strong>
- <code>variable</code> - Beliebiger Bezeichner (lowercase empfohlen)
- <code>collection</code> - Table-Name aus Storage-Layer</p>
<p><strong>Multi-Collection (Joins - MVP seit 31.10.2025):</strong></p>
<p>Themis unterstützt Nested-Loop-Joins über mehrere Collections via sequenzielle <code>FOR</code>-Klauseln:</p>
<pre><code class="language-aql">FOR u IN users
  FOR o IN orders
    FILTER o.user_id == u._key
    RETURN {user: u.name, order: o.id}
</code></pre>
<p><strong>Join-Arten (MVP):</strong>
- <strong>Equality Join:</strong> Verknüpfung über <code>FILTER var1.field == var2.field</code>
- <strong>Cross Product + Filter:</strong> Kartesisches Produkt mit nachträglicher Filterung</p>
<p><strong>Beispiel - User-City-Join:</strong></p>
<pre><code class="language-aql">FOR user IN users
  FOR city IN cities
    FILTER user.city_id == city._key
    RETURN {
      user_name: user.name,
      city_name: city.name,
      country: city.country
    }
</code></pre>
<p><strong>Performance-Hinweise:</strong>
- ⚠️ Nested-Loop kann <strong>teuer</strong> sein bei großen Datasets (O(n×m) Komplexität)
- 💡 Empfehlung: FILTER-Bedingungen so spezifisch wie möglich
- 💡 Zukünftig: Hash-Join-Optimierung für große Collections geplant
- 💡 Verwende Indizes auf Join-Spalten (z.B. <code>city_id</code>) wo möglich</p>
<p><strong>Multi-FOR Limitierungen (MVP):</strong>
- Maximal 2-3 FOR-Klauseln empfohlen (Performance)
- Join-Bedingung muss in FILTER sein (keine impliziten Joins)
- Nur Equality-Joins (<code>==</code>) optimiert</p>
<hr />
<h3 id="2-filter-bedingungen">2. FILTER - Bedingungen<a class="headerlink" href="#2-filter-bedingungen" title="Permanent link">&para;</a></h3>
<p><strong>Vergleichsoperatoren:</strong></p>
<pre><code class="language-aql">FILTER doc.age == 25          // Gleichheit
FILTER doc.age != 25          // Ungleichheit
FILTER doc.age &gt; 18           // Größer
FILTER doc.age &gt;= 18          // Größer-Gleich
FILTER doc.age &lt; 65           // Kleiner
FILTER doc.age &lt;= 65          // Kleiner-Gleich
</code></pre>
<p><strong>Logische Operatoren:</strong></p>
<pre><code class="language-aql">FILTER doc.age &gt; 18 AND doc.city == &quot;Berlin&quot;
FILTER doc.status == &quot;active&quot; OR doc.status == &quot;pending&quot;   // Hinweis: OR im MVP noch nicht unterstützt
FILTER NOT doc.deleted
</code></pre>
<p><strong>IN-Operator:</strong></p>
<pre><code class="language-aql">FILTER doc.status IN [&quot;active&quot;, &quot;pending&quot;, &quot;approved&quot;]
FILTER doc.age IN [18, 21, 25, 30]
</code></pre>
<p><strong>String-Operatoren:</strong></p>
<pre><code class="language-aql">FILTER LIKE(doc.name, &quot;Max%&quot;)           // Prefix-Match
FILTER CONTAINS(doc.description, &quot;AI&quot;)  // Substring
FILTER REGEX_TEST(doc.email, &quot;.*@example\.com&quot;)
</code></pre>
<p><strong>NULL-Checks:</strong></p>
<pre><code class="language-aql">FILTER doc.email != null
FILTER doc.phone == null
</code></pre>
<hr />
<h3 id="3-sort-sortierung">3. SORT - Sortierung<a class="headerlink" href="#3-sort-sortierung" title="Permanent link">&para;</a></h3>
<p><strong>Einfache Sortierung:</strong></p>
<pre><code class="language-aql">SORT doc.age                  // ASC (default)
SORT doc.age DESC
SORT doc.created_at DESC
</code></pre>
<p><strong>Multi-Column-Sort:</strong></p>
<pre><code class="language-aql">SORT doc.city ASC, doc.age DESC
SORT doc.priority DESC, doc.created_at ASC
</code></pre>
<p><strong>Index-Nutzung:</strong>
- Range-Index auf <code>age</code> → effiziente Sortierung
- Composite-Index <code>(city, age)</code> → optimale Multi-Column-Sort</p>
<hr />
<h3 id="4-limit-pagination">4. LIMIT - Pagination<a class="headerlink" href="#4-limit-pagination" title="Permanent link">&para;</a></h3>
<p><strong>Syntax:</strong></p>
<pre><code class="language-aql">LIMIT count                   // Erste N Ergebnisse
LIMIT offset, count           // Pagination
</code></pre>
<p><strong>Beispiele:</strong></p>
<pre><code class="language-aql">LIMIT 10                      // Erste 10
LIMIT 20, 10                  // Zeilen 21-30 (Seite 3)
</code></pre>
<p><strong>Best Practices:</strong>
- Immer mit <code>LIMIT</code> arbeiten (verhindert Full-Scans)
- Für große Offsets: Cursor-basierte Pagination bevorzugen</p>
<hr />
<h3 id="5-return-projektion">5. RETURN - Projektion<a class="headerlink" href="#5-return-projektion" title="Permanent link">&para;</a></h3>
<p><strong>Ganzes Dokument:</strong></p>
<pre><code class="language-aql">RETURN doc
</code></pre>
<p><strong>Einzelne Felder:</strong></p>
<pre><code class="language-aql">RETURN doc.name
RETURN doc.email
</code></pre>
<p><strong>Objekt-Konstruktion:</strong></p>
<pre><code class="language-aql">RETURN {
  name: doc.name,
  age: doc.age,
  city: doc.city
}
</code></pre>
<p><strong>Berechnete Felder:</strong></p>
<pre><code class="language-aql">RETURN {
  name: doc.name,
  age_in_months: doc.age * 12,
  full_address: CONCAT(doc.street, &quot;, &quot;, doc.city)
}
</code></pre>
<p><strong>Arrays:</strong></p>
<pre><code class="language-aql">RETURN [doc.name, doc.age, doc.city]
</code></pre>
<p>Unterstützte Ausdrücke im MVP:
- Literale: Zahl, String, Bool, null
- Variablen und Feldzugriff: <code>doc</code>, <code>doc.field</code>
- Objekt- und Array-Literale (verschachtelt möglich)
- Einfache Let-Bindings pro Zeile (siehe LET)</p>
<hr />
<h2 id="erweiterte-features-phase-11">Erweiterte Features (Phase 1.1+)<a class="headerlink" href="#erweiterte-features-phase-11" title="Permanent link">&para;</a></h2>
<h3 id="let-variable-binding-mvp-seit-31102025">LET - Variable Binding (MVP seit 31.10.2025)<a class="headerlink" href="#let-variable-binding-mvp-seit-31102025" title="Permanent link">&para;</a></h3>
<p>Bindet pro Iteration Werte an Variablen, die in <code>FILTER</code> und <code>RETURN</code> genutzt werden können.</p>
<p><strong>Einfaches Beispiel:</strong></p>
<pre><code class="language-aql">FOR u IN users
  LET city_name = u.city
  RETURN {name: u.name, city: city_name}
</code></pre>
<p><strong>Berechnungen mit LET:</strong></p>
<pre><code class="language-aql">FOR product IN products
  LET total_value = product.price * product.quantity
  FILTER total_value &gt; 1000
  RETURN {
    product: product.name,
    value: total_value
  }
</code></pre>
<p><strong>Mehrere LET-Bindungen:</strong></p>
<pre><code class="language-aql">FOR sale IN sales
  LET net = sale.amount
  LET tax = net * 0.19
  LET gross = net + tax
  RETURN {sale_id: sale._key, net, tax, gross}
</code></pre>
<p><strong>LET in Joins:</strong></p>
<pre><code class="language-aql">FOR user IN users
  FOR order IN orders
    FILTER order.user_id == user._key
    LET full_name = CONCAT(user.first_name, &quot; &quot;, user.last_name)
    RETURN {customer: full_name, order_id: order._key}
</code></pre>
<p><strong>MVP-Einschränkungen:</strong>
- Unterstützt sind aktuell einfache Ausdrücke: Literale, Variablen, Feldzugriffe, Binäroperationen (+, -, *, /), Objekt-/Array-Literale
- LETs werden sequenziell ausgewertet; spätere LETs können frühere verwenden
- Komplexe Funktionen (CONCAT, SUBSTRING, etc.) in Entwicklung
- Explain: Wenn <code>LET</code>‑Variablen in <code>FILTER</code> zu einfachen Gleichheitsprädikaten vor der Übersetzung extrahiert wurden, enthält der Plan das Flag <code>plan.let_pre_extracted = true</code></p>
<hr />
<h3 id="collect-aggregationen-mvp-seit-31102025">COLLECT - Aggregationen (MVP seit 31.10.2025)<a class="headerlink" href="#collect-aggregationen-mvp-seit-31102025" title="Permanent link">&para;</a></h3>
<p>Gruppiert Ergebnisse und berechnet Aggregatfunktionen.</p>
<p><strong>Einfaches GROUP BY:</strong></p>
<pre><code class="language-aql">FOR user IN users
  COLLECT city = user.city
  RETURN {city, count: LENGTH(1)}
</code></pre>
<p><strong>COUNT-Aggregation:</strong></p>
<pre><code class="language-aql">FOR user IN users
  COLLECT city = user.city WITH COUNT INTO total
  RETURN {city, total}
</code></pre>
<p><strong>SUM-Aggregation:</strong></p>
<pre><code class="language-aql">FOR sale IN sales
  COLLECT category = sale.category
  AGGREGATE total_revenue = SUM(sale.amount)
  RETURN {category, total_revenue}
</code></pre>
<p><strong>Mehrere Aggregationen:</strong></p>
<pre><code class="language-aql">FOR order IN orders
  COLLECT status = order.status
  AGGREGATE 
    total_count = COUNT(),
    total_amount = SUM(order.amount),
    avg_amount = AVG(order.amount),
    min_amount = MIN(order.amount),
    max_amount = MAX(order.amount)
  RETURN {status, total_count, total_amount, avg_amount, min_amount, max_amount}
</code></pre>
<p><strong>COLLECT mit FILTER:</strong></p>
<pre><code class="language-aql">FOR user IN users
  FILTER user.age &gt; 18
  COLLECT city = user.city
  AGGREGATE adult_count = COUNT()
  RETURN {city, adult_count}
</code></pre>
<p><strong>Unterstützte Aggregatfunktionen (MVP):</strong>
- <code>COUNT()</code> - Anzahl der Gruppen-Elemente
- <code>SUM(expr)</code> - Summe eines numerischen Felds
- <code>AVG(expr)</code> - Durchschnitt eines numerischen Felds
- <code>MIN(expr)</code> - Minimum eines Felds
- <code>MAX(expr)</code> - Maximum eines Felds</p>
<p><strong>Performance-Hinweise:</strong>
- Hash-basiertes Grouping: O(n) Komplexität
- FILTER vor COLLECT reduziert Datenvolumen (wird automatisch optimiert)
- Für sehr große Gruppen: Memory-Nutzung beachten</p>
<p><strong>Geplante Erweiterungen:</strong>
- <code>STDDEV(expr)</code> - Standardabweichung
- <code>VARIANCE(expr)</code> - Varianz
- <code>PERCENTILE(expr, n)</code> - n-tes Perzentil
- <code>UNIQUE(expr)</code> - Distinct Values</p>
<p>Hinweise (MVP):
- Gruppierung erfolgt über exakte String-Matches der Group-Keys
- Mehrere GROUP BY-Felder via Tuple-Keys geplant
- HAVING-Clause (Post-Aggregation-Filter) in Entwicklung</p>
<hr />
<h2 id="http-spezifische-parameter-fur-pagination">HTTP-spezifische Parameter für Pagination<a class="headerlink" href="#http-spezifische-parameter-fur-pagination" title="Permanent link">&para;</a></h2>
<p>Bei Nutzung des HTTP-Endpunkts <code>POST /query/aql</code> können optionale Felder zur Pagination mitgegeben werden:</p>
<pre><code class="language-json">{
  &quot;query&quot;: &quot;FOR u IN users SORT u.age ASC LIMIT 10 RETURN u&quot;,
  &quot;use_cursor&quot;: true,
  &quot;cursor&quot;: &quot;&lt;token-aus-previous-response&gt;&quot;,
  &quot;allow_full_scan&quot;: false
}
</code></pre>
<ul>
<li><code>use_cursor</code> (bool): Aktiviert Cursor-basierte Pagination. Antwortformat enthält <code>{items, has_more, next_cursor, batch_size}</code>.</li>
<li><code>cursor</code> (string): Token aus <code>next_cursor</code> der vorherigen Seite. Gültig nur in Kombination mit <code>use_cursor: true</code>.</li>
<li><code>allow_full_scan</code> (bool): Optionaler Fallback für kleine Datenmengen/Tests; für große Daten wird Index-basierte Sortierung empfohlen.</li>
</ul>
<p>Weitere Details siehe <code>docs/cursor_pagination.md</code>.</p>
<hr />
<h2 id="spezial-queries">Spezial-Queries<a class="headerlink" href="#spezial-queries" title="Permanent link">&para;</a></h2>
<h3 id="graph-traversierung">Graph-Traversierung<a class="headerlink" href="#graph-traversierung" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR v, e, p IN 1..3 OUTBOUND &quot;users/alice&quot; edges
  FILTER v.active == true
  RETURN {vertex: v, edge: e, path: p}
</code></pre>
<p><strong>Traversal-Richtungen:</strong>
- <code>OUTBOUND</code> - Ausgehende Kanten (Alice → Bob)
- <code>INBOUND</code> - Eingehende Kanten (Alice ← Bob)
- <code>ANY</code> - Beide Richtungen</p>
<p><strong>Depth-Limits:</strong>
- <code>1..1</code> - Nur direkte Nachbarn
- <code>1..3</code> - Bis zu 3 Hops
- <code>2..5</code> - Min 2, Max 5 Hops</p>
<hr />
<h3 id="vektor-ahnlichkeitssuche">Vektor-Ähnlichkeitssuche<a class="headerlink" href="#vektor-ahnlichkeitssuche" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR doc IN users
  NEAR(doc.embedding, @query_vector, 10)
  FILTER doc.age &gt; 18
  RETURN {name: doc.name, similarity: SIMILARITY()}
</code></pre>
<p><strong>Funktionen:</strong>
- <code>NEAR(field, vector, k)</code> - k-NN-Suche
- <code>SIMILARITY()</code> - Aktueller Similarity-Score (0.0 - 1.0)</p>
<p><strong>Metriken:</strong></p>
<pre><code class="language-aql">NEAR(doc.embedding, @query_vector, 10, &quot;cosine&quot;)    // Cosine Similarity
NEAR(doc.embedding, @query_vector, 10, &quot;euclidean&quot;) // L2-Distance
</code></pre>
<hr />
<h3 id="geo-queries">Geo-Queries<a class="headerlink" href="#geo-queries" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR doc IN locations
  GEO_DISTANCE(doc.lat, doc.lon, 52.52, 13.405) &lt; 5000
  RETURN {name: doc.name, distance: GEO_DISTANCE(doc.lat, doc.lon, 52.52, 13.405)}
</code></pre>
<p><strong>Funktionen:</strong>
- <code>GEO_DISTANCE(lat1, lon1, lat2, lon2)</code> - Haversine-Distanz (Meter)
- <code>GEO_BOX(lat, lon, minLat, maxLat, minLon, maxLon)</code> - Bounding-Box-Check</p>
<hr />
<h3 id="fulltext-suche">Fulltext-Suche<a class="headerlink" href="#fulltext-suche" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR doc IN articles
  FULLTEXT(doc.content, &quot;machine learning AI&quot;)
  SORT BM25(doc) DESC
  LIMIT 10
  RETURN {title: doc.title, score: BM25(doc)}
</code></pre>
<p><strong>Funktionen:</strong>
- <code>FULLTEXT(field, query)</code> - Tokenisierte Suche
- <code>BM25(doc)</code> - Relevanz-Score (0.0+)</p>
<hr />
<h2 id="einfache-joins-mvp">Einfache Joins (MVP)<a class="headerlink" href="#einfache-joins-mvp" title="Permanent link">&para;</a></h2>
<p>Unterstützt werden Equality-Joins über genau zwei <code>FOR</code>-Klauseln mit einem Gleichheitsprädikat zwischen Variablen.</p>
<pre><code class="language-aql">FOR u IN users
  FOR o IN orders
  FILTER u._key == o.user_id
  RETURN u
</code></pre>
<p>Eigenschaften und Einschränkungen (MVP):
- Genau zwei <code>FOR</code>‑Klauseln; ein Equality‑Prädikat <code>var1.field == var2.field</code> in <code>FILTER</code>.
- Zusätzliche <code>FILTER</code> pro Seite sind erlaubt und werden vor dem Join angewendet.
- <code>RETURN</code> muss aktuell eine der Variablen zurückgeben (typisch <code>u</code> oder <code>o</code>).
- <code>LIMIT</code> wird nach dem Join angewendet. <code>SORT</code> im Join‑Pfad ist derzeit nicht unterstützt.
- <code>explain: true</code> liefert einen Plan, der den Join‑Pfad ausweist; bei LET‑Pre‑Extraction wird <code>plan.let_pre_extracted = true</code> gesetzt.</p>
<p>Projektion mit LET im Join-Kontext:</p>
<pre><code class="language-aql">FOR u IN users
  FOR o IN orders
  FILTER u._key == o.user_id
  LET info = { user: u.name, order: o.id }
  RETURN info
</code></pre>
<p>Hinweis: Komplexe Projektionen können je nach Datenvolumen höhere Kosten verursachen; nutze <code>LIMIT</code> wo sinnvoll.</p>
<hr />
<h2 id="funktionen-operatoren">Funktionen &amp; Operatoren<a class="headerlink" href="#funktionen-operatoren" title="Permanent link">&para;</a></h2>
<h3 id="string-funktionen">String-Funktionen<a class="headerlink" href="#string-funktionen" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">CONCAT(str1, str2, ...)       // &quot;Hello&quot; + &quot; &quot; + &quot;World&quot;
LOWER(str)                     // &quot;HELLO&quot; → &quot;hello&quot;
UPPER(str)                     // &quot;hello&quot; → &quot;HELLO&quot;
SUBSTRING(str, offset, length) // &quot;Hello&quot;[1:4] → &quot;ell&quot;
LENGTH(str)                    // &quot;Hello&quot; → 5
TRIM(str)                      // &quot;  Hello  &quot; → &quot;Hello&quot;
</code></pre>
<h3 id="numeric-funktionen">Numeric-Funktionen<a class="headerlink" href="#numeric-funktionen" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">ABS(num)                       // |-5| → 5
CEIL(num) / FLOOR(num)         // 3.7 → 4 / 3
ROUND(num, decimals)           // 3.14159, 2 → 3.14
SQRT(num)                      // √16 → 4
POW(base, exp)                 // 2^8 → 256
</code></pre>
<h3 id="aggregations-in-collect">Aggregations (in COLLECT)<a class="headerlink" href="#aggregations-in-collect" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">COUNT()                        // Anzahl Zeilen
SUM(expr)                      // Summe
AVG(expr)                      // Durchschnitt
MIN(expr) / MAX(expr)          // Minimum/Maximum
STDDEV(expr)                   // Standardabweichung
VARIANCE(expr)                 // Varianz
</code></pre>
<h3 id="type-checks">Type-Checks<a class="headerlink" href="#type-checks" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">IS_NULL(value)
IS_NUMBER(value)
IS_STRING(value)
IS_ARRAY(value)
IS_OBJECT(value)
</code></pre>
<hr />
<h2 id="beispiel-queries">Beispiel-Queries<a class="headerlink" href="#beispiel-queries" title="Permanent link">&para;</a></h2>
<h3 id="1-einfache-filterung">1. Einfache Filterung<a class="headerlink" href="#1-einfache-filterung" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR user IN users
  FILTER user.age &gt; 18 AND user.city == &quot;Berlin&quot;
  SORT user.created_at DESC
  LIMIT 10
  RETURN {
    name: user.name,
    email: user.email,
    age: user.age
  }
</code></pre>
<p><strong>Optimizer:</strong>
- Nutzt Composite-Index <code>(city, age)</code> falls vorhanden
- Fallback: Equality-Index <code>city</code> + Full-Scan-Filter <code>age</code></p>
<hr />
<h3 id="2-geo-proximity-search">2. Geo-Proximity-Search<a class="headerlink" href="#2-geo-proximity-search" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR loc IN restaurants
  FILTER GEO_DISTANCE(loc.lat, loc.lon, 52.52, 13.405) &lt; 2000
  FILTER loc.rating &gt;= 4.0
  SORT GEO_DISTANCE(loc.lat, loc.lon, 52.52, 13.405) ASC
  LIMIT 5
  RETURN {
    name: loc.name,
    rating: loc.rating,
    distance: GEO_DISTANCE(loc.lat, loc.lon, 52.52, 13.405)
  }
</code></pre>
<p><strong>Optimizer:</strong>
- Nutzt Geo-Index für Bounding-Box-Scan
- Post-Filter für exakte Distanz-Berechnung</p>
<hr />
<h3 id="3-vektor-suche-mit-filter">3. Vektor-Suche mit Filter<a class="headerlink" href="#3-vektor-suche-mit-filter" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR product IN products
  NEAR(product.embedding, @query_vector, 20)
  FILTER product.price &lt; 100.0 AND product.in_stock == true
  SORT SIMILARITY() DESC
  LIMIT 10
  RETURN {
    name: product.name,
    price: product.price,
    similarity: SIMILARITY()
  }
</code></pre>
<p><strong>Pre-Filtering vs Post-Filtering:</strong>
- Pre-Filter: Bitset für <code>price &lt; 100 AND in_stock == true</code> → k-NN
- Post-Filter: k-NN (20) → Filter → Top-10</p>
<hr />
<h3 id="4-aggregationen">4. Aggregationen<a class="headerlink" href="#4-aggregationen" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR order IN orders
  FILTER order.created_at &gt;= &quot;2025-01-01&quot;
  COLLECT city = order.city
  AGGREGATE 
    total_revenue = SUM(order.amount),
    avg_order = AVG(order.amount),
    order_count = COUNT()
  SORT total_revenue DESC
  LIMIT 10
  RETURN {
    city,
    total_revenue,
    avg_order,
    order_count
  }
</code></pre>
<hr />
<h3 id="5-graph-traversierung">5. Graph-Traversierung<a class="headerlink" href="#5-graph-traversierung" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR vertex, edge, path IN 1..3 OUTBOUND &quot;users/alice&quot; friendships
  FILTER vertex.active == true
  RETURN {
    friend: vertex.name,
    connection_type: edge.type,
    path_length: LENGTH(path.edges)
  }
</code></pre>
<hr />
<h2 id="query-execution-optimizer">Query-Execution &amp; Optimizer<a class="headerlink" href="#query-execution-optimizer" title="Permanent link">&para;</a></h2>
<h3 id="explain-plan">Explain-Plan<a class="headerlink" href="#explain-plan" title="Permanent link">&para;</a></h3>
<pre><code class="language-json">POST /query/aql
{
  &quot;query&quot;: &quot;FOR u IN users FILTER u.age &gt; 18 SORT u.created_at DESC LIMIT 10&quot;,
  &quot;explain&quot;: true
}
</code></pre>
<p><strong>Response:</strong></p>
<pre><code class="language-json">{
  &quot;plan&quot;: {
    &quot;mode&quot;: &quot;range_aware&quot;,
    &quot;order&quot;: [
      { &quot;column&quot;: &quot;created_at&quot;, &quot;value&quot;: &quot;DESC&quot; }
    ],
    &quot;estimates&quot;: [
      { &quot;column&quot;: &quot;age&quot;, &quot;value&quot;: &quot;&gt; 18&quot;, &quot;estimatedCount&quot;: 1200, &quot;capped&quot;: false }
    ],
    &quot;let_pre_extracted&quot;: true
  }
}
</code></pre>
<h3 id="index-hints-spater">Index-Hints (später)<a class="headerlink" href="#index-hints-spater" title="Permanent link">&para;</a></h3>
<pre><code class="language-aql">FOR doc IN users USE INDEX idx_age_city
  FILTER doc.age &gt; 18
  RETURN doc
</code></pre>
<hr />
<h2 id="ast-struktur-internal">AST-Struktur (Internal)<a class="headerlink" href="#ast-struktur-internal" title="Permanent link">&para;</a></h2>
<pre><code class="language-cpp">// AST-Node-Typen
enum class ASTNodeType {
    ForNode,          // FOR variable IN collection
    FilterNode,       // FILTER condition
    SortNode,         // SORT expr [ASC|DESC]
    LimitNode,        // LIMIT offset, count
    ReturnNode,       // RETURN expression

    // Expressions
    BinaryOp,         // ==, !=, &gt;, &lt;, &gt;=, &lt;=, AND, OR
    UnaryOp,          // NOT, -
    FunctionCall,     // CONCAT, SUM, etc.
    FieldAccess,      // doc.field
    Literal,          // &quot;string&quot;, 123, true, null
    Variable          // doc, user, etc.
};

// Beispiel-AST für: FOR u IN users FILTER u.age &gt; 18 RETURN u.name
ForNode {
    variable: &quot;u&quot;,
    collection: &quot;users&quot;,

    filter: FilterNode {
        condition: BinaryOp {
            op: &quot;&gt;&quot;,
            left: FieldAccess(&quot;u&quot;, &quot;age&quot;),
            right: Literal(18)
        }
    },

    return_expr: ReturnNode {
        expression: FieldAccess(&quot;u&quot;, &quot;name&quot;)
    }
}
</code></pre>
<hr />
<h2 id="implementierungs-phasen">Implementierungs-Phasen<a class="headerlink" href="#implementierungs-phasen" title="Permanent link">&para;</a></h2>
<h3 id="phase-1-mvp-woche-1-2">Phase 1 (MVP - Woche 1-2):<a class="headerlink" href="#phase-1-mvp-woche-1-2" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ FOR, FILTER (Equality, Range, IN), SORT, LIMIT, RETURN</li>
<li>✅ Parser (PEGTL)</li>
<li>✅ AST → QueryEngine-Translation</li>
<li>✅ HTTP-Endpoint <code>/query/aql</code></li>
<li>✅ Unit-Tests</li>
</ul>
<h3 id="phase-2-woche-3-4">Phase 2 (Woche 3-4):<a class="headerlink" href="#phase-2-woche-3-4" title="Permanent link">&para;</a></h3>
<ul>
<li>LET (Variable Binding)</li>
<li>COLLECT (Aggregationen: COUNT, SUM, AVG)</li>
<li>String-/Numeric-Funktionen</li>
<li>Explain-Plan-Integration</li>
</ul>
<h3 id="phase-3-woche-5-6">Phase 3 (Woche 5-6):<a class="headerlink" href="#phase-3-woche-5-6" title="Permanent link">&para;</a></h3>
<ul>
<li>Graph-Traversierung (FOR v, e, p IN ... OUTBOUND)</li>
<li>Vektor-Suche (NEAR, SIMILARITY)</li>
<li>Geo-Queries (GEO_DISTANCE, GEO_BOX)</li>
<li>Fulltext (FULLTEXT, BM25)</li>
</ul>
<h3 id="phase-4-spater">Phase 4 (später):<a class="headerlink" href="#phase-4-spater" title="Permanent link">&para;</a></h3>
<ul>
<li>Joins (Multi-Collection)</li>
<li>Subqueries</li>
<li>Transactions (BEGIN, COMMIT, ROLLBACK)</li>
<li>INSERT, UPDATE, DELETE via AQL</li>
</ul>
<hr />
<h2 id="performance-uberlegungen">Performance-Überlegungen<a class="headerlink" href="#performance-uberlegungen" title="Permanent link">&para;</a></h2>
<p><strong>Index-Nutzung:</strong>
- FILTER mit <code>==</code> → Equality-Index
- FILTER mit <code>&gt;</code>, <code>&lt;</code> → Range-Index
- FILTER mit <code>IN</code> → Batch-Lookup
- SORT → Range-Index (wenn vorhanden)</p>
<p><strong>Optimizer-Strategien:</strong>
- <strong>Filter-Pushdown:</strong> FILTER vor SORT (reduziert Sortier-Kosten)
- <strong>Index-Auswahl:</strong> Kleinster geschätzter Index zuerst
- <strong>Short-Circuit:</strong> LIMIT früh anwenden (z.B. Top-K)</p>
<p><strong>Vermeiden:</strong>
- Full-Table-Scans ohne LIMIT
- Sortierung ohne Index auf großen Datasets
- Aggregationen ohne COLLECT (ineffizient)</p>
<hr />
<h2 id="kompatibilitat-erweiterungen">Kompatibilität &amp; Erweiterungen<a class="headerlink" href="#kompatibilitat-erweiterungen" title="Permanent link">&para;</a></h2>
<p><strong>ArangoDB AQL:</strong>
- Ähnliche Syntax (FOR, FILTER, SORT, LIMIT, RETURN)
- Unterschiede: THEMIS nutzt natives MVCC, kein <code>_key</code> zwingend</p>
<p><strong>SQL-Vergleich:</strong></p>
<pre><code class="language-sql">-- SQL
SELECT name, age FROM users WHERE age &gt; 18 ORDER BY created_at DESC LIMIT 10;

-- AQL
FOR user IN users
  FILTER user.age &gt; 18
  SORT user.created_at DESC
  LIMIT 10
  RETURN {name: user.name, age: user.age}
</code></pre>
<p><strong>Vorteile AQL:</strong>
- Multi-Modell (Graph, Vector, Geo in einer Query)
- Explizite Execution-Reihenfolge (leichter zu optimieren)
- Schemalos (flexible Felder)</p>
<hr />
<h2 id="fehlerbehandlung">Fehlerbehandlung<a class="headerlink" href="#fehlerbehandlung" title="Permanent link">&para;</a></h2>
<p><strong>Syntax-Errors:</strong></p>
<pre><code class="language-json">{
  &quot;error&quot;: &quot;Syntax error at line 2, column 10: Expected 'IN' after variable name&quot;,
  &quot;query&quot;: &quot;FOR user users FILTER ...&quot;,
  &quot;line&quot;: 2,
  &quot;column&quot;: 10
}
</code></pre>
<p><strong>Semantic-Errors:</strong></p>
<pre><code class="language-json">{
  &quot;error&quot;: &quot;Collection 'userz' does not exist (did you mean 'users'?)&quot;,
  &quot;query&quot;: &quot;FOR u IN userz RETURN u&quot;
}
</code></pre>
<p><strong>Runtime-Errors:</strong></p>
<pre><code class="language-json">{
  &quot;error&quot;: &quot;Division by zero in expression: amount / quantity&quot;,
  &quot;entity_key&quot;: &quot;orders:12345&quot;
}
</code></pre>
<hr />
<h2 id="referenz-links">Referenz-Links<a class="headerlink" href="#referenz-links" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Parser:</strong> PEGTL (https://github.com/taocpp/PEGTL)</li>
<li><strong>Inspiration:</strong> ArangoDB AQL (https://www.arangodb.com/docs/stable/aql/)</li>
<li><strong>Optimizer:</strong> docs/query_optimizer.md</li>
<li><strong>Index-Typen:</strong> docs/indexes.md</li>
</ul>
<hr />
<p><strong>Status:</strong> ✅ Syntax-Definition vollständig<br />
<strong>Nächster Schritt:</strong> Parser-Implementation mit PEGTL</p>
<h2 id="vollstandige-beispiele-mvp-features">Vollständige Beispiele (MVP Features)<a class="headerlink" href="#vollstandige-beispiele-mvp-features" title="Permanent link">&para;</a></h2>
<h3 id="beispiel-1-user-city-join-mit-aggregation">Beispiel 1: User-City-Join mit Aggregation<a class="headerlink" href="#beispiel-1-user-city-join-mit-aggregation" title="Permanent link">&para;</a></h3>
<p><strong>Szenario:</strong> Finde alle User in ihren Städten, gruppiert nach Land mit Zählung:</p>
<pre><code class="language-aql">FOR user IN users
  FOR city IN cities
    FILTER user.city_id == city._key
    COLLECT country = city.country
    AGGREGATE user_count = COUNT()
    RETURN {country, user_count}
</code></pre>
<p><strong>Ergebnis:</strong></p>
<pre><code class="language-json">[
  {&quot;country&quot;: &quot;Germany&quot;, &quot;user_count&quot;: 125},
  {&quot;country&quot;: &quot;France&quot;, &quot;user_count&quot;: 87},
  {&quot;country&quot;: &quot;Spain&quot;, &quot;user_count&quot;: 43}
]
</code></pre>
<hr />
<h3 id="beispiel-2-sales-analyse-mit-let-und-aggregation">Beispiel 2: Sales-Analyse mit LET und Aggregation<a class="headerlink" href="#beispiel-2-sales-analyse-mit-let-und-aggregation" title="Permanent link">&para;</a></h3>
<p><strong>Szenario:</strong> Berechne Netto/Brutto-Umsätze pro Kategorie:</p>
<pre><code class="language-aql">FOR sale IN sales
  LET net = sale.amount
  LET tax = net * 0.19
  LET gross = net + tax
  COLLECT category = sale.category
  AGGREGATE 
    total_net = SUM(net),
    total_gross = SUM(gross),
    count = COUNT()
  RETURN {
    category,
    total_net,
    total_gross,
    avg_sale: total_net / count,
    count
  }
</code></pre>
<hr />
<h3 id="beispiel-3-top-10-stadte-nach-user-count">Beispiel 3: Top-10 Städte nach User-Count<a class="headerlink" href="#beispiel-3-top-10-stadte-nach-user-count" title="Permanent link">&para;</a></h3>
<p><strong>Szenario:</strong> Häufigste Städte finden:</p>
<pre><code class="language-aql">FOR user IN users
  COLLECT city_id = user.city_id WITH COUNT INTO user_count
  SORT user_count DESC
  LIMIT 10
  RETURN {city_id, user_count}
</code></pre>
<hr />
<h2 id="performance-best-practices-mvp">Performance-Best-Practices (MVP)<a class="headerlink" href="#performance-best-practices-mvp" title="Permanent link">&para;</a></h2>
<h3 id="1-join-optimierung">1. JOIN-Optimierung<a class="headerlink" href="#1-join-optimierung" title="Permanent link">&para;</a></h3>
<p>** Schlecht:<strong> Kartesisches Produkt ohne Filter
** Gut:</strong> Spezifische FILTER-Bedingungen, LIMIT verwenden</p>
<h3 id="2-let-fur-wiederverwendung">2. LET für Wiederverwendung<a class="headerlink" href="#2-let-fur-wiederverwendung" title="Permanent link">&para;</a></h3>
<p>Berechnungen einmal durchführen, mehrfach nutzen:</p>
<pre><code class="language-aql">FOR sale IN sales
  LET net = sale.amount
  LET tax = net * 0.19
  RETURN {net, tax, gross: net + tax}
</code></pre>
<h3 id="3-filter-vor-collect">3. FILTER vor COLLECT<a class="headerlink" href="#3-filter-vor-collect" title="Permanent link">&para;</a></h3>
<p>Datenvolumen reduzieren bevor gruppiert wird.</p>
<hr />
<h2 id="implementation-status-31102025">Implementation-Status (31.10.2025)<a class="headerlink" href="#implementation-status-31102025" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Status</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FOR</strong> (Single)</td>
<td>Production</td>
<td>Vollständig optimiert</td>
</tr>
<tr>
<td><strong>FOR</strong> (Multi/Join)</td>
<td>MVP</td>
<td>Nested-Loop, Hash-Join geplant</td>
</tr>
<tr>
<td><strong>FILTER</strong></td>
<td>Production</td>
<td>Equality + Range + AND</td>
</tr>
<tr>
<td><strong>SORT</strong></td>
<td>Production</td>
<td>Index-optimiert</td>
</tr>
<tr>
<td><strong>LIMIT</strong></td>
<td>Production</td>
<td>Offset + Count</td>
</tr>
<tr>
<td><strong>RETURN</strong></td>
<td>Production</td>
<td>Field/Object/Array</td>
</tr>
<tr>
<td><strong>LET</strong></td>
<td>MVP</td>
<td>Basis-Expressions, Arithmetik</td>
</tr>
<tr>
<td><strong>COLLECT</strong></td>
<td>MVP</td>
<td>Hash-Grouping, COUNT/SUM/AVG/MIN/MAX</td>
</tr>
<tr>
<td><strong>OR-Operator</strong></td>
<td>Planned</td>
<td>Index-Merge geplant</td>
</tr>
<tr>
<td><strong>Subqueries</strong></td>
<td>Planned</td>
<td>Phase 1.2</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Dokumentations-Version:</strong> 1.1 (31. Oktober 2025)<br />
<strong>Letzte Aktualisierung:</strong> JOIN/LET/COLLECT MVP-Features dokumentiert</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.instant", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version": "Version ausw\u00e4hlen"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>