
<!doctype html>
<html lang="de" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Offizielle Dokumentation für ThemisDB (Architektur, Storage, Query/AQL, Sicherheit, APIs und Betrieb)">
      
      
      
        <link rel="canonical" href="https://example.local/themisdb/docs/encryption_deployment/">
      
      
        <link rel="prev" href="../encryption_strategy/">
      
      
        <link rel="next" href="../column_encryption/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Verschlüsselungsdeployment - ThemisDB Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#themis-column-level-encryption-production-deployment-guide" class="md-skip">
          Zum Inhalt
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Kopfzeile">
    <a href=".." title="ThemisDB Docs" class="md-header__button md-logo" aria-label="ThemisDB Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ThemisDB Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Verschlüsselungsdeployment
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Suche" placeholder="Suche" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Suche">
        
        <button type="reset" class="md-search__icon md-icon" title="Zurücksetzen" aria-label="Zurücksetzen" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Suche wird initialisiert
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/makr-code/ThemisDB" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    makr-code/ThemisDB
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Hauptnavigation" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Übersicht

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../architecture/" class="md-tabs__link">
        
  
  
    
  
  Architektur

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../base_entity/" class="md-tabs__link">
          
  
  
  Basismodell

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../storage/geo_relational_schema/" class="md-tabs__link">
          
  
  
  Storage & MVCC

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../indexes/" class="md-tabs__link">
          
  
  
  Indexe & Statistiken

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../query_engine_aql/" class="md-tabs__link">
          
  
  
  Query & AQL

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../content_pipeline/" class="md-tabs__link">
          
  
  
  Content Pipeline

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../search/hybrid_search_design/" class="md-tabs__link">
          
  
  
  Suche

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../performance_benchmarks/" class="md-tabs__link">
          
  
  
  Performance & Benchmarks

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../quality_assurance/" class="md-tabs__link">
        
  
  
    
  
  Qualitätssicherung

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../vector_ops/" class="md-tabs__link">
          
  
  
  Vektor & GNN

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../security/overview/" class="md-tabs__link">
          
  
  
  Sicherheit & Governance

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../deployment/" class="md-tabs__link">
          
  
  
  Deployment & Betrieb

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../publishing/" class="md-tabs__link">
        
  
  
    
  
  Publikation & Ablage

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../admin_tools_admin_guide/" class="md-tabs__link">
          
  
  
  Admin-Tools

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../apis/openapi/" class="md-tabs__link">
          
  
  
  APIs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../styleguide/" class="md-tabs__link">
          
  
  
  Styleguide & Glossar

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../roadmap/" class="md-tabs__link">
        
  
  
    
  
  Roadmap

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../print_page/" class="md-tabs__link">
        
  
  
    
  
  Gesamte Dokumentation (Druckansicht)

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ThemisDB Docs" class="md-nav__button md-logo" aria-label="ThemisDB Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ThemisDB Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/makr-code/ThemisDB" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    makr-code/ThemisDB
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Übersicht
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architektur
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basismodell
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Basismodell
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base_entity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Entity & Keys
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../path_constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pfad-Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../property_graph_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Property Graph Modell
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Storage & MVCC
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Storage & MVCC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage/geo_relational_schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Storage-Layout (Geo/Relational)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage/rocksdb_layout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RocksDB Storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mvcc_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MVCC-Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transactions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transaktionen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time_series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time-Series Überblick
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory_tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Tuning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Indexe & Statistiken
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Indexe & Statistiken
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../indexes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Indexe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index_stats_maintenance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index-Statistiken & Wartung
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cursor_pagination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cursor/Pagination
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Query & AQL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Query & AQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../query_engine_aql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query Engine & AQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aql_syntax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AQL Syntax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aql_explain_profile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Explain & Profile
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recursive_path_queries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rekursive Pfadabfragen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../temporal_graphs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Temporale Graphen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../temporal_time_range_queries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zeitbereichs-Abfragen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../semantic_cache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semantischer Cache
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Content Pipeline
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Content Pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Content Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content_architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architektur-Details
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content/ingestion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ingestion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ingestion/json_ingestion_spec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JSON Ingestion Spec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content/geo_processor_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Geo-Processor Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../content/image_processor_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image-Processor Design
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Suche
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Suche
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search/hybrid_search_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hybrid Search Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search/pagination_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pagination Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Performance & Benchmarks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Performance & Benchmarks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Überblick & Tuning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compression_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kompression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search/pagination_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pagination Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quality_assurance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qualitätssicherung
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vektor & GNN
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Vektor & GNN
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vector_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vektor-Operationen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gnn_embeddings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GNN Embeddings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hnsw_persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HNSW Persistenz & Warmstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" checked>
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Sicherheit & Governance
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Sicherheit & Governance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Überblick
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rbac_authorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RBAC & Authorization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/key_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schlüsselverwaltung
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encryption_strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Verschlüsselungsstrategie
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Verschlüsselungsdeployment
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Verschlüsselungsdeployment
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-coverage" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Coverage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#infrastructure-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Infrastructure Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Infrastructure Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hashicorp-vault" class="md-nav__link">
    <span class="md-ellipsis">
      HashiCorp Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-servers" class="md-nav__link">
    <span class="md-ellipsis">
      Application Servers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database" class="md-nav__link">
    <span class="md-ellipsis">
      Database
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Software Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Access Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#component-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Component Diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Data Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hashicorp-vault-setup" class="md-nav__link">
    <span class="md-ellipsis">
      HashiCorp Vault Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HashiCorp Vault Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-deploy-vault-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Deploy Vault Cluster
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1: Deploy Vault Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#production-ha-setup-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Production HA Setup (Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-tls-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Generate TLS Certificates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-initialize-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Initialize Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-enable-kv-secrets-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Enable KV Secrets Engine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-create-encryption-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Create Encryption Keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-create-application-policy" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Create Application Policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-configure-approle-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Configure AppRole Authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-management-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Key Management Strategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Management Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-categorization" class="md-nav__link">
    <span class="md-ellipsis">
      Key Categorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-versioning-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Key Versioning Scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-rotation-schedule" class="md-nav__link">
    <span class="md-ellipsis">
      Key Rotation Schedule
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Application Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Application Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vaultkeyprovider-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      VaultKeyProvider Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes Deployment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-from-plaintext" class="md-nav__link">
    <span class="md-ellipsis">
      Migration from Plaintext
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migration from Plaintext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-assessment-week-1" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: Assessment (Week 1)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-schema-changes-week-2" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Schema Changes (Week 2)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-dual-write-migration-week-3-4" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3: Dual-Write Migration (Week 3-4)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-switch-reads-week-5" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 4: Switch Reads (Week 5)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-cleanup-week-6" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 5: Cleanup (Week 6+)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-rotation-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Key Rotation Procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Rotation Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual-rotation-process" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Rotation Process
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re-encryption-job-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Re-Encryption Job Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-alerting" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring &amp; Alerting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring &amp; Alerting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Key Metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Application Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grafana-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Grafana Dashboard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alerting-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Alerting Rules
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disaster-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Disaster Recovery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Disaster Recovery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backup-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Backup Procedures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery Procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recovery Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scenario-1-lost-vault-token" class="md-nav__link">
    <span class="md-ellipsis">
      Scenario 1: Lost Vault Token
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-2-vault-cluster-failure" class="md-nav__link">
    <span class="md-ellipsis">
      Scenario 2: Vault Cluster Failure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-3-corrupted-encryption-key" class="md-nav__link">
    <span class="md-ellipsis">
      Scenario 3: Corrupted Encryption Key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Security Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-key-storage" class="md-nav__link">
    <span class="md-ellipsis">
      1. Key Storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      2. Access Control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-network-security" class="md-nav__link">
    <span class="md-ellipsis">
      3. Network Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-audit-logging" class="md-nav__link">
    <span class="md-ellipsis">
      4. Audit Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      5. Monitoring
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#issue-slow-encryption-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Issue: Slow Encryption Performance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-vault-connection-timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      Issue: Vault Connection Timeouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-cache-thrashing" class="md-nav__link">
    <span class="md-ellipsis">
      Issue: Cache Thrashing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Tuning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Tuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#benchmark-results" class="md-nav__link">
    <span class="md-ellipsis">
      Benchmark Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimization-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Optimization Checklist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-key-rotation-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      A. Key Rotation Checklist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-emergency-contacts" class="md-nav__link">
    <span class="md-ellipsis">
      B. Emergency Contacts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-compliance-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      C. Compliance Matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../column_encryption/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spaltenverschlüsselung
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/pii_detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PII-Detection (Überblick)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pii_detection_engines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PII-Detection Engines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pii_engine_signing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PII Engine Signing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/audit_and_retention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Audit & Retention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/threat_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security_hardening_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Hardening Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security_audit_checklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Audit Checklist
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compliance_audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance Audit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compliance_governance_strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Governance-Strategie
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compliance_integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance-Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../governance_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Governance Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/security_compliance_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security/Compliance Review
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deployment & Betrieb
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Deployment & Betrieb
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tracing & Observability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../change_data_capture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Change Data Capture (CDC)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operations_runbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operations Runbook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Publikation & Ablage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Admin-Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Admin-Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_admin_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Admin Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_user_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_feature_matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_search_sort_filter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suche/Sortierung/Filter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin_tools_demo_script/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Demo-Script
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    APIs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apis/openapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAPI & Endpunkte
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apis/openapi.md#sse-streaming-changefeed" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SSE-Streaming (Changefeed)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Styleguide & Glossar
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            Styleguide & Glossar
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../styleguide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Styleguide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossar
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roadmap
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../print_page/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gesamte Dokumentation (Druckansicht)
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-coverage" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Coverage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#infrastructure-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Infrastructure Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Infrastructure Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hashicorp-vault" class="md-nav__link">
    <span class="md-ellipsis">
      HashiCorp Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-servers" class="md-nav__link">
    <span class="md-ellipsis">
      Application Servers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database" class="md-nav__link">
    <span class="md-ellipsis">
      Database
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Software Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Access Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#component-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Component Diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Data Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hashicorp-vault-setup" class="md-nav__link">
    <span class="md-ellipsis">
      HashiCorp Vault Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HashiCorp Vault Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-deploy-vault-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Deploy Vault Cluster
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1: Deploy Vault Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#production-ha-setup-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Production HA Setup (Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-tls-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Generate TLS Certificates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-initialize-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Initialize Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-enable-kv-secrets-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Enable KV Secrets Engine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-create-encryption-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Create Encryption Keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-create-application-policy" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Create Application Policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-configure-approle-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Configure AppRole Authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-management-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Key Management Strategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Management Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-categorization" class="md-nav__link">
    <span class="md-ellipsis">
      Key Categorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-versioning-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Key Versioning Scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-rotation-schedule" class="md-nav__link">
    <span class="md-ellipsis">
      Key Rotation Schedule
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Application Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Application Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vaultkeyprovider-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      VaultKeyProvider Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes Deployment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-from-plaintext" class="md-nav__link">
    <span class="md-ellipsis">
      Migration from Plaintext
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migration from Plaintext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-assessment-week-1" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: Assessment (Week 1)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-schema-changes-week-2" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Schema Changes (Week 2)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-dual-write-migration-week-3-4" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3: Dual-Write Migration (Week 3-4)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-switch-reads-week-5" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 4: Switch Reads (Week 5)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-cleanup-week-6" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 5: Cleanup (Week 6+)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-rotation-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Key Rotation Procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Rotation Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual-rotation-process" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Rotation Process
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re-encryption-job-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Re-Encryption Job Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-alerting" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring &amp; Alerting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring &amp; Alerting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Key Metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Application Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grafana-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Grafana Dashboard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alerting-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Alerting Rules
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disaster-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Disaster Recovery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Disaster Recovery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backup-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Backup Procedures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery Procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recovery Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scenario-1-lost-vault-token" class="md-nav__link">
    <span class="md-ellipsis">
      Scenario 1: Lost Vault Token
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-2-vault-cluster-failure" class="md-nav__link">
    <span class="md-ellipsis">
      Scenario 2: Vault Cluster Failure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-3-corrupted-encryption-key" class="md-nav__link">
    <span class="md-ellipsis">
      Scenario 3: Corrupted Encryption Key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Security Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-key-storage" class="md-nav__link">
    <span class="md-ellipsis">
      1. Key Storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      2. Access Control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-network-security" class="md-nav__link">
    <span class="md-ellipsis">
      3. Network Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-audit-logging" class="md-nav__link">
    <span class="md-ellipsis">
      4. Audit Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      5. Monitoring
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#issue-slow-encryption-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Issue: Slow Encryption Performance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-vault-connection-timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      Issue: Vault Connection Timeouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-cache-thrashing" class="md-nav__link">
    <span class="md-ellipsis">
      Issue: Cache Thrashing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Tuning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Tuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#benchmark-results" class="md-nav__link">
    <span class="md-ellipsis">
      Benchmark Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimization-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Optimization Checklist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-key-rotation-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      A. Key Rotation Checklist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-emergency-contacts" class="md-nav__link">
    <span class="md-ellipsis">
      B. Emergency Contacts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-compliance-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      C. Compliance Matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="themis-column-level-encryption-production-deployment-guide">Themis Column-Level Encryption - Production Deployment Guide<a class="headerlink" href="#themis-column-level-encryption-production-deployment-guide" title="Permanent link">&para;</a></h1>
<p><strong>Version:</strong> 1.0<br />
<strong>Last Updated:</strong> 30. Oktober 2025<br />
<strong>Target Audience:</strong> DevOps Engineers, Security Engineers, Database Administrators</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#hashicorp-vault-setup">HashiCorp Vault Setup</a></li>
<li><a href="#key-management-strategy">Key Management Strategy</a></li>
<li><a href="#application-configuration">Application Configuration</a></li>
<li><a href="#migration-from-plaintext">Migration from Plaintext</a></li>
<li><a href="#key-rotation-procedures">Key Rotation Procedures</a></li>
<li><a href="#monitoring--alerting">Monitoring &amp; Alerting</a></li>
<li><a href="#disaster-recovery">Disaster Recovery</a></li>
<li><a href="#security-best-practices">Security Best Practices</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#performance-tuning">Performance Tuning</a></li>
</ol>
<hr />
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Themis implements <strong>column-level encryption</strong> using <strong>AES-256-GCM</strong> to protect sensitive data at rest. This guide covers deploying the encryption system in production with HashiCorp Vault as the key management backend.</p>
<h3 id="key-features">Key Features<a class="headerlink" href="#key-features" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ <strong>AES-256-GCM</strong> encryption (NIST-approved)</li>
<li>✅ <strong>Authenticated encryption</strong> (integrity + confidentiality)</li>
<li>✅ <strong>Hardware acceleration</strong> (AES-NI auto-detected)</li>
<li>✅ <strong>Key versioning</strong> for zero-downtime rotation</li>
<li>✅ <strong>Vault integration</strong> for enterprise key management</li>
<li>✅ <strong>Transparent field-level encryption</strong> (minimal code changes)</li>
</ul>
<h3 id="compliance-coverage">Compliance Coverage<a class="headerlink" href="#compliance-coverage" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Regulation</th>
<th>Requirement</th>
<th>Themis Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>GDPR</strong></td>
<td>Data encryption at rest</td>
<td>✅ AES-256-GCM</td>
</tr>
<tr>
<td><strong>HIPAA</strong></td>
<td>PHI encryption</td>
<td>✅ Separate key for medical data</td>
</tr>
<tr>
<td><strong>PCI DSS</strong></td>
<td>Cardholder data protection</td>
<td>✅ Field-level encryption</td>
</tr>
<tr>
<td><strong>SOC 2</strong></td>
<td>Key management controls</td>
<td>✅ Vault integration + audit logs</td>
</tr>
<tr>
<td><strong>CCPA</strong></td>
<td>Consumer data protection</td>
<td>✅ Right to be forgotten support</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<h3 id="infrastructure-requirements">Infrastructure Requirements<a class="headerlink" href="#infrastructure-requirements" title="Permanent link">&para;</a></h3>
<h4 id="hashicorp-vault">HashiCorp Vault<a class="headerlink" href="#hashicorp-vault" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Version:</strong> Vault 1.15+ recommended</li>
<li><strong>Deployment:</strong> HA cluster (3+ nodes) for production</li>
<li><strong>Storage Backend:</strong> Consul (recommended) or Raft integrated storage</li>
<li><strong>TLS:</strong> Required for production (mutual TLS recommended)</li>
</ul>
<h4 id="application-servers">Application Servers<a class="headerlink" href="#application-servers" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>CPU:</strong> AES-NI support (Intel/AMD x86-64)</li>
<li>Check: <code>grep -E 'aes|sse4_2' /proc/cpuinfo</code> (Linux)</li>
<li>Check: <code>sysctl -a | grep machdep.cpu.features</code> (macOS)</li>
<li><strong>Memory:</strong> +512MB heap for key cache</li>
<li><strong>Network:</strong> Low-latency connection to Vault (&lt;5ms RTT recommended)</li>
</ul>
<h4 id="database">Database<a class="headerlink" href="#database" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>RocksDB:</strong> Storage for encrypted data</li>
<li><strong>Disk:</strong> SSD recommended for encrypted blob performance</li>
<li><strong>Space:</strong> Plan for 20-30% overhead vs plaintext</li>
</ul>
<h3 id="software-dependencies">Software Dependencies<a class="headerlink" href="#software-dependencies" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash"># Required libraries (installed via vcpkg)
curl &gt;= 8.0
openssl &gt;= 3.0
nlohmann-json &gt;= 3.11
rocksdb &gt;= 8.0
</code></pre>
<h3 id="access-requirements">Access Requirements<a class="headerlink" href="#access-requirements" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Vault Admin Access:</strong> For initial setup and key creation</li>
<li><strong>Application Service Account:</strong> Vault token or AppRole authentication</li>
<li><strong>Network Access:</strong> Application → Vault (port 8200, TLS)</li>
</ul>
<hr />
<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link">&para;</a></h2>
<h3 id="component-diagram">Component Diagram<a class="headerlink" href="#component-diagram" title="Permanent link">&para;</a></h3>
<pre><code>┌─────────────────────────────────────────────────────────┐
│                    Application Layer                     │
├─────────────────────────────────────────────────────────┤
│                                                           │
│  ┌─────────────┐     ┌──────────────────┐              │
│  │   User      │────▶│ EncryptedField&lt;T&gt;│              │
│  │   Customer  │     │   - email        │              │
│  │   Document  │     │   - ssn          │              │
│  └─────────────┘     │   - credit_score │              │
│                      └──────────┬───────┘              │
│                                 │                        │
│                      ┌──────────▼────────┐              │
│                      │  FieldEncryption  │              │
│                      │  (AES-256-GCM)    │              │
│                      └──────────┬────────┘              │
│                                 │                        │
│                      ┌──────────▼────────┐              │
│                      │  VaultKeyProvider │              │
│                      │  - Key caching    │              │
│                      │  - Token refresh  │              │
│                      └──────────┬────────┘              │
└──────────────────────────────────┼──────────────────────┘
                                   │ HTTPS/TLS
                      ┌────────────▼─────────────┐
                      │   HashiCorp Vault        │
                      │   KV Secrets Engine v2   │
                      ├──────────────────────────┤
                      │  Keys:                   │
                      │   - user_pii (v1, v2)   │
                      │   - user_sensitive (v1) │
                      │   - customer_financial  │
                      └──────────────────────────┘
                                   │
                      ┌────────────▼─────────────┐
                      │   Vault Storage          │
                      │   (Consul/Raft)          │
                      └──────────────────────────┘
</code></pre>
<h3 id="data-flow">Data Flow<a class="headerlink" href="#data-flow" title="Permanent link">&para;</a></h3>
<p><strong>Write Path (Encryption):</strong></p>
<pre><code>1. User.email = &quot;alice@example.com&quot;
2. EncryptedField.encrypt(&quot;alice@example.com&quot;, &quot;user_pii&quot;)
3. VaultKeyProvider.getKey(&quot;user_pii&quot;) → [Check cache]
4. If cache miss: HTTP GET /v1/themis/data/keys/user_pii
5. Vault returns: {data: {key: &quot;&lt;base64&gt;&quot;, version: 2}}
6. Cache key for 1 hour
7. FieldEncryption.encrypt(plaintext, key) → AES-256-GCM
8. Generate random IV (96 bits)
9. Encrypt + generate auth tag (128 bits)
10. Return: &quot;user_pii:2:IV:ciphertext:tag&quot; (base64)
11. Store in RocksDB as JSON: {&quot;email&quot;: &quot;user_pii:2:...&quot;}
</code></pre>
<p><strong>Read Path (Decryption):</strong></p>
<pre><code>1. Fetch from RocksDB: {&quot;email&quot;: &quot;user_pii:2:IV:ciphertext:tag&quot;}
2. EncryptedField.fromBase64(&quot;user_pii:2:...&quot;)
3. Parse: key_id=&quot;user_pii&quot;, version=2, IV, ciphertext, tag
4. VaultKeyProvider.getKey(&quot;user_pii&quot;, version=2) → [Check cache]
5. If cache miss: HTTP GET /v1/themis/data/keys/user_pii?version=2
6. FieldEncryption.decrypt(ciphertext, key, IV, tag)
7. Verify authentication tag (prevents tampering)
8. Decrypt using AES-256-GCM
9. Return plaintext: &quot;alice@example.com&quot;
</code></pre>
<hr />
<h2 id="hashicorp-vault-setup">HashiCorp Vault Setup<a class="headerlink" href="#hashicorp-vault-setup" title="Permanent link">&para;</a></h2>
<h3 id="step-1-deploy-vault-cluster">Step 1: Deploy Vault Cluster<a class="headerlink" href="#step-1-deploy-vault-cluster" title="Permanent link">&para;</a></h3>
<h4 id="production-ha-setup-recommended">Production HA Setup (Recommended)<a class="headerlink" href="#production-ha-setup-recommended" title="Permanent link">&para;</a></h4>
<pre><code class="language-bash"># Using Docker Compose for quick setup
# For production, use Kubernetes/Nomad or systemd

cat &gt; docker-compose.yml &lt;&lt;EOF
version: '3.8'
services:
  vault1:
    image: hashicorp/vault:1.15
    container_name: vault-1
    ports:
      - &quot;8200:8200&quot;
    environment:
      VAULT_ADDR: 'https://0.0.0.0:8200'
      VAULT_API_ADDR: 'https://vault-1:8200'
    volumes:
      - ./vault/config:/vault/config:ro
      - ./vault/data:/vault/data
      - ./vault/logs:/vault/logs
    cap_add:
      - IPC_LOCK
    command: server

  vault2:
    image: hashicorp/vault:1.15
    container_name: vault-2
    ports:
      - &quot;8201:8200&quot;
    environment:
      VAULT_ADDR: 'https://0.0.0.0:8200'
      VAULT_API_ADDR: 'https://vault-2:8200'
    volumes:
      - ./vault/config:/vault/config:ro
      - ./vault/data2:/vault/data
      - ./vault/logs2:/vault/logs
    cap_add:
      - IPC_LOCK
    command: server

  vault3:
    image: hashicorp/vault:1.15
    container_name: vault-3
    ports:
      - &quot;8202:8200&quot;
    environment:
      VAULT_ADDR: 'https://0.0.0.0:8200'
      VAULT_API_ADDR: 'https://vault-3:8200'
    volumes:
      - ./vault/config:/vault/config:ro
      - ./vault/data3:/vault/data
      - ./vault/logs3:/vault/logs
    cap_add:
      - IPC_LOCK
    command: server

  consul:
    image: hashicorp/consul:1.16
    container_name: consul
    ports:
      - &quot;8500:8500&quot;
    command: agent -server -ui -bootstrap-expect=1 -client=0.0.0.0
EOF

# Vault configuration
mkdir -p vault/config
cat &gt; vault/config/vault.hcl &lt;&lt;EOF
storage &quot;consul&quot; {
  address = &quot;consul:8500&quot;
  path    = &quot;vault/&quot;
}

listener &quot;tcp&quot; {
  address     = &quot;0.0.0.0:8200&quot;
  tls_cert_file = &quot;/vault/config/tls/vault.crt&quot;
  tls_key_file  = &quot;/vault/config/tls/vault.key&quot;
}

api_addr = &quot;https://vault-1:8200&quot;
cluster_addr = &quot;https://vault-1:8201&quot;
ui = true

# Performance tuning
max_lease_ttl = &quot;87600h&quot;  # 10 years
default_lease_ttl = &quot;87600h&quot;

# Enable Prometheus metrics
telemetry {
  prometheus_retention_time = &quot;24h&quot;
  disable_hostname = true
}
EOF

docker-compose up -d
</code></pre>
<h4 id="generate-tls-certificates">Generate TLS Certificates<a class="headerlink" href="#generate-tls-certificates" title="Permanent link">&para;</a></h4>
<pre><code class="language-bash"># Create CA
openssl req -x509 -newkey rsa:4096 -keyout vault/config/tls/ca-key.pem \
  -out vault/config/tls/ca.pem -days 3650 -nodes \
  -subj &quot;/C=US/ST=CA/L=SF/O=Themis/CN=Vault CA&quot;

# Create Vault certificate
openssl req -newkey rsa:4096 -keyout vault/config/tls/vault.key \
  -out vault/config/tls/vault.csr -nodes \
  -subj &quot;/C=US/ST=CA/L=SF/O=Themis/CN=vault.example.com&quot;

openssl x509 -req -in vault/config/tls/vault.csr \
  -CA vault/config/tls/ca.pem -CAkey vault/config/tls/ca-key.pem \
  -CAcreateserial -out vault/config/tls/vault.crt -days 825 \
  -extensions v3_req -extfile &lt;(cat &lt;&lt;EOF
[v3_req]
subjectAltName = @alt_names
[alt_names]
DNS.1 = vault.example.com
DNS.2 = localhost
IP.1 = 127.0.0.1
EOF
)
</code></pre>
<h3 id="step-2-initialize-vault">Step 2: Initialize Vault<a class="headerlink" href="#step-2-initialize-vault" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash">export VAULT_ADDR='https://vault.example.com:8200'
export VAULT_CACERT='/path/to/ca.pem'

# Initialize (DO THIS ONCE)
vault operator init -key-shares=5 -key-threshold=3 &gt; vault-init.txt

# CRITICAL: Store unseal keys and root token securely!
# Distribute unseal keys to different trusted personnel

# Unseal all 3 nodes (requires 3 of 5 keys)
vault operator unseal &lt;key1&gt;
vault operator unseal &lt;key2&gt;
vault operator unseal &lt;key3&gt;

# Login with root token
vault login &lt;root-token&gt;
</code></pre>
<h3 id="step-3-enable-kv-secrets-engine">Step 3: Enable KV Secrets Engine<a class="headerlink" href="#step-3-enable-kv-secrets-engine" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash"># Enable KV v2 secrets engine
vault secrets enable -version=2 -path=themis kv

# Verify
vault secrets list
# Should show:
# themis/    kv    n/a       n/a     n/a        n/a   28h24m30s   n/a
</code></pre>
<h3 id="step-4-create-encryption-keys">Step 4: Create Encryption Keys<a class="headerlink" href="#step-4-create-encryption-keys" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash"># Helper script to generate encryption keys
cat &gt; create-encryption-key.sh &lt;&lt;'EOF'
#!/bin/bash
set -e

KEY_ID=$1
DESCRIPTION=$2

if [ -z &quot;$KEY_ID&quot; ]; then
  echo &quot;Usage: $0 &lt;key_id&gt; [description]&quot;
  exit 1
fi

# Generate 256-bit random key
KEY=$(openssl rand -base64 32)

# Store in Vault
vault kv put themis/keys/$KEY_ID \
  key=&quot;$KEY&quot; \
  algorithm=&quot;AES-256-GCM&quot; \
  version=1 \
  description=&quot;$DESCRIPTION&quot; \
  created_at=&quot;$(date -u +%Y-%m-%dT%H:%M:%SZ)&quot;

echo &quot;✅ Created key: $KEY_ID&quot;
vault kv get themis/keys/$KEY_ID
EOF

chmod +x create-encryption-key.sh

# Create keys for different data categories
./create-encryption-key.sh user_pii &quot;General user PII (email, phone, address)&quot;
./create-encryption-key.sh user_sensitive &quot;High-sensitivity user data (SSN, medical records)&quot;
./create-encryption-key.sh customer_financial &quot;Financial data (credit scores, income)&quot;
./create-encryption-key.sh payment_info &quot;Payment card data (PCI DSS)&quot;
</code></pre>
<h3 id="step-5-create-application-policy">Step 5: Create Application Policy<a class="headerlink" href="#step-5-create-application-policy" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash"># Policy for Themis application
cat &gt; themis-policy.hcl &lt;&lt;EOF
# Read access to encryption keys
path &quot;themis/data/keys/*&quot; {
  capabilities = [&quot;read&quot;, &quot;list&quot;]
}

# Read key metadata (for rotation monitoring)
path &quot;themis/metadata/keys/*&quot; {
  capabilities = [&quot;read&quot;, &quot;list&quot;]
}

# Deny write/delete (keys managed by admins only)
path &quot;themis/data/keys/*&quot; {
  capabilities = [&quot;deny&quot;]
  denied_parameters = {
    &quot;*&quot; = []
  }
}
EOF

vault policy write themis-app themis-policy.hcl

# Verify
vault policy read themis-app
</code></pre>
<h3 id="step-6-configure-approle-authentication">Step 6: Configure AppRole Authentication<a class="headerlink" href="#step-6-configure-approle-authentication" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash"># Enable AppRole auth
vault auth enable approle

# Create role for Themis application
vault write auth/approle/role/themis-app \
  token_ttl=1h \
  token_max_ttl=4h \
  token_policies=&quot;themis-app&quot; \
  secret_id_ttl=0 \
  secret_id_num_uses=0

# Get role ID
vault read auth/approle/role/themis-app/role-id
# role_id: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

# Generate secret ID
vault write -f auth/approle/role/themis-app/secret-id
# secret_id: yyyyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy

# Store role_id and secret_id securely (e.g., Kubernetes secrets)
</code></pre>
<hr />
<h2 id="key-management-strategy">Key Management Strategy<a class="headerlink" href="#key-management-strategy" title="Permanent link">&para;</a></h2>
<h3 id="key-categorization">Key Categorization<a class="headerlink" href="#key-categorization" title="Permanent link">&para;</a></h3>
<p>Organize keys by <strong>data sensitivity</strong> and <strong>rotation frequency</strong>:</p>
<table>
<thead>
<tr>
<th>Key ID</th>
<th>Purpose</th>
<th>Data Examples</th>
<th>Rotation Frequency</th>
<th>Compliance</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>user_pii</code></td>
<td>General PII</td>
<td>Email, phone, address</td>
<td>12 months</td>
<td>GDPR, CCPA</td>
</tr>
<tr>
<td><code>user_sensitive</code></td>
<td>High-sensitivity PII</td>
<td>SSN, passport, medical ID</td>
<td>6 months</td>
<td>HIPAA, GDPR</td>
</tr>
<tr>
<td><code>customer_financial</code></td>
<td>Financial data</td>
<td>Credit score, income</td>
<td>6 months</td>
<td>PCI DSS, SOC 2</td>
</tr>
<tr>
<td><code>payment_info</code></td>
<td>Payment cards</td>
<td>Card number, CVV</td>
<td>3 months</td>
<td>PCI DSS</td>
</tr>
<tr>
<td><code>healthcare_phi</code></td>
<td>Protected health info</td>
<td>Diagnoses, prescriptions</td>
<td>6 months</td>
<td>HIPAA</td>
</tr>
</tbody>
</table>
<h3 id="key-versioning-scheme">Key Versioning Scheme<a class="headerlink" href="#key-versioning-scheme" title="Permanent link">&para;</a></h3>
<pre><code>Key Format: &lt;key_id&gt;:&lt;version&gt;:&lt;iv&gt;:&lt;ciphertext&gt;:&lt;tag&gt;
Example:    user_pii:2:ghQO6IvYuVdlrXna:qh6kXp9P6dPJlceX4hMes4U=:H9/fjZNKYg==

Version Lifecycle:
  v1: ACTIVE    → Encrypts new data, decrypts old data
  v2: ROTATING  → Dual-write phase (v1 deprecated, v2 active)
  v1: DEPRECATED→ Decrypts old data only (no new encryptions)
  v1: DELETED   → After grace period (90 days), physically deleted
</code></pre>
<h3 id="key-rotation-schedule">Key Rotation Schedule<a class="headerlink" href="#key-rotation-schedule" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash"># Automated rotation cron job (run monthly)
cat &gt; /etc/cron.monthly/rotate-encryption-keys.sh &lt;&lt;'EOF'
#!/bin/bash
set -e

VAULT_ADDR=&quot;https://vault.example.com:8200&quot;
VAULT_TOKEN=&quot;&lt;service-account-token&gt;&quot;

# Rotate keys older than 6 months
for KEY_ID in user_sensitive customer_financial healthcare_phi; do
  CURRENT_VERSION=$(vault kv get -format=json themis/keys/$KEY_ID | jq -r '.data.metadata.version')
  NEW_VERSION=$((CURRENT_VERSION + 1))

  NEW_KEY=$(openssl rand -base64 32)

  vault kv put themis/keys/$KEY_ID \
    key=&quot;$NEW_KEY&quot; \
    algorithm=&quot;AES-256-GCM&quot; \
    version=$NEW_VERSION \
    created_at=&quot;$(date -u +%Y-%m-%dT%H:%M:%SZ)&quot; \
    rotated_from_version=$CURRENT_VERSION

  echo &quot;✅ Rotated $KEY_ID: v$CURRENT_VERSION → v$NEW_VERSION&quot;

  # Trigger application re-encryption job
  curl -X POST https://themis-api.example.com/admin/re-encrypt \
    -H &quot;Authorization: Bearer $ADMIN_TOKEN&quot; \
    -d &quot;{\&quot;key_id\&quot;: \&quot;$KEY_ID\&quot;, \&quot;target_version\&quot;: $NEW_VERSION}&quot;
done
EOF

chmod +x /etc/cron.monthly/rotate-encryption-keys.sh
</code></pre>
<hr />
<h2 id="application-configuration">Application Configuration<a class="headerlink" href="#application-configuration" title="Permanent link">&para;</a></h2>
<h3 id="vaultkeyprovider-configuration">VaultKeyProvider Configuration<a class="headerlink" href="#vaultkeyprovider-configuration" title="Permanent link">&para;</a></h3>
<pre><code class="language-cpp">// config/encryption.hpp
#include &quot;security/vault_key_provider.h&quot;

themis::VaultKeyProvider::Config getVaultConfig() {
    themis::VaultKeyProvider::Config config;

    // Vault connection
    config.vault_addr = std::getenv(&quot;VAULT_ADDR&quot;) ?: &quot;https://vault.example.com:8200&quot;;
    config.vault_token = std::getenv(&quot;VAULT_TOKEN&quot;) ?: &quot;&quot;;  // From AppRole login
    config.kv_mount_path = &quot;themis&quot;;
    config.kv_version = &quot;v2&quot;;

    // TLS configuration
    config.verify_ssl = true;
    config.ca_cert_path = &quot;/etc/ssl/certs/vault-ca.pem&quot;;

    // Performance tuning
    config.cache_ttl_seconds = 3600;      // 1 hour cache
    config.cache_capacity = 1000;         // Max 1000 cached keys
    config.request_timeout_ms = 5000;     // 5 second timeout

    // Connection pooling (if using custom HTTP client)
    config.max_connections = 10;
    config.keepalive = true;

    return config;
}

// Initialize in application startup
void initializeEncryption() {
    auto vault_config = getVaultConfig();
    auto key_provider = std::make_shared&lt;themis::VaultKeyProvider&gt;(vault_config);
    auto encryption = std::make_shared&lt;themis::FieldEncryption&gt;(key_provider);

    // Set global encryption for all field types
    themis::EncryptedField&lt;std::string&gt;::setFieldEncryption(encryption);
    themis::EncryptedField&lt;int64_t&gt;::setFieldEncryption(encryption);
    themis::EncryptedField&lt;double&gt;::setFieldEncryption(encryption);

    // Warm up cache with frequently used keys
    key_provider-&gt;getKey(&quot;user_pii&quot;);
    key_provider-&gt;getKey(&quot;user_sensitive&quot;);
    key_provider-&gt;getKey(&quot;customer_financial&quot;);
}
</code></pre>
<h3 id="environment-variables">Environment Variables<a class="headerlink" href="#environment-variables" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash"># Production environment (.env file)
VAULT_ADDR=https://vault.example.com:8200
VAULT_TOKEN=&lt;from-approle-login&gt;
VAULT_CACERT=/etc/ssl/certs/vault-ca.pem
VAULT_NAMESPACE=themis  # For Vault Enterprise

# Optional: Override defaults
ENCRYPTION_CACHE_TTL=3600
ENCRYPTION_CACHE_SIZE=1000
ENCRYPTION_KEY_MOUNT=themis
</code></pre>
<h3 id="kubernetes-deployment">Kubernetes Deployment<a class="headerlink" href="#kubernetes-deployment" title="Permanent link">&para;</a></h3>
<pre><code class="language-yaml"># kubernetes/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: themis-api
  namespace: production
spec:
  replicas: 3
  selector:
    matchLabels:
      app: themis-api
  template:
    metadata:
      labels:
        app: themis-api
    spec:
      serviceAccountName: themis-app
      containers:
      - name: themis-api
        image: themis:latest
        env:
        - name: VAULT_ADDR
          value: &quot;https://vault.vault.svc.cluster.local:8200&quot;
        - name: VAULT_TOKEN
          valueFrom:
            secretKeyRef:
              name: vault-token
              key: token
        - name: VAULT_CACERT
          value: &quot;/vault/tls/ca.crt&quot;
        volumeMounts:
        - name: vault-tls
          mountPath: /vault/tls
          readOnly: true
        resources:
          requests:
            memory: &quot;2Gi&quot;
            cpu: &quot;1000m&quot;
          limits:
            memory: &quot;4Gi&quot;
            cpu: &quot;2000m&quot;
        livenessProbe:
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8080
          initialDelaySeconds: 10
          periodSeconds: 5
      volumes:
      - name: vault-tls
        secret:
          secretName: vault-ca-cert

---
# Vault token secret (from AppRole login)
apiVersion: v1
kind: Secret
metadata:
  name: vault-token
  namespace: production
type: Opaque
data:
  token: &lt;base64-encoded-vault-token&gt;
</code></pre>
<hr />
<h2 id="migration-from-plaintext">Migration from Plaintext<a class="headerlink" href="#migration-from-plaintext" title="Permanent link">&para;</a></h2>
<h3 id="phase-1-assessment-week-1">Phase 1: Assessment (Week 1)<a class="headerlink" href="#phase-1-assessment-week-1" title="Permanent link">&para;</a></h3>
<pre><code class="language-sql">-- Identify columns to encrypt
SELECT 
  table_name,
  column_name,
  data_type,
  COUNT(*) as row_count,
  SUM(LENGTH(column_name)) as total_bytes
FROM information_schema.columns
WHERE column_name IN ('email', 'ssn', 'phone', 'credit_card')
GROUP BY table_name, column_name;

-- Estimate migration time
-- Rule of thumb: 10,000 rows/second on modern hardware
</code></pre>
<h3 id="phase-2-schema-changes-week-2">Phase 2: Schema Changes (Week 2)<a class="headerlink" href="#phase-2-schema-changes-week-2" title="Permanent link">&para;</a></h3>
<pre><code class="language-cpp">// Add encrypted columns alongside plaintext (dual-write phase)
struct User {
    std::string id;
    std::string username;

    // OLD: Plaintext (deprecated)
    std::string email_plaintext;
    std::string ssn_plaintext;

    // NEW: Encrypted
    EncryptedField&lt;std::string&gt; email;
    EncryptedField&lt;std::string&gt; ssn;

    // Migration flag
    bool is_encrypted = false;
};
</code></pre>
<h3 id="phase-3-dual-write-migration-week-3-4">Phase 3: Dual-Write Migration (Week 3-4)<a class="headerlink" href="#phase-3-dual-write-migration-week-3-4" title="Permanent link">&para;</a></h3>
<pre><code class="language-cpp">// Write to both plaintext and encrypted columns
void saveUser(const User&amp; user) {
    // Write plaintext (for backward compatibility)
    db-&gt;put(&quot;user:&quot; + user.id + &quot;:email_plain&quot;, user.email_plaintext);

    // Write encrypted
    user.email.encrypt(user.email_plaintext, &quot;user_pii&quot;);
    auto encrypted_blob = user.email.toBase64();
    db-&gt;put(&quot;user:&quot; + user.id + &quot;:email_enc&quot;, encrypted_blob);

    // Mark as encrypted
    db-&gt;put(&quot;user:&quot; + user.id + &quot;:encrypted&quot;, &quot;true&quot;);
}

// Background migration job
void migrateUserData() {
    auto all_users = db-&gt;scan(&quot;user:&quot;);

    for (const auto&amp; [key, value] : all_users) {
        std::string user_id = extractUserId(key);

        // Skip if already encrypted
        auto encrypted_flag = db-&gt;get(&quot;user:&quot; + user_id + &quot;:encrypted&quot;);
        if (encrypted_flag == &quot;true&quot;) continue;

        // Migrate plaintext to encrypted
        auto email_plain = db-&gt;get(&quot;user:&quot; + user_id + &quot;:email_plain&quot;);
        if (!email_plain.empty()) {
            EncryptedField&lt;std::string&gt; email_enc;
            email_enc.encrypt(email_plain, &quot;user_pii&quot;);
            db-&gt;put(&quot;user:&quot; + user_id + &quot;:email_enc&quot;, email_enc.toBase64());
        }

        db-&gt;put(&quot;user:&quot; + user_id + &quot;:encrypted&quot;, &quot;true&quot;);

        // Log progress
        std::cout &lt;&lt; &quot;Migrated user: &quot; &lt;&lt; user_id &lt;&lt; std::endl;
    }
}
</code></pre>
<h3 id="phase-4-switch-reads-week-5">Phase 4: Switch Reads (Week 5)<a class="headerlink" href="#phase-4-switch-reads-week-5" title="Permanent link">&para;</a></h3>
<pre><code class="language-cpp">// Preferentially read from encrypted columns
std::string getUserEmail(const std::string&amp; user_id) {
    // Try encrypted first
    auto encrypted_data = db-&gt;get(&quot;user:&quot; + user_id + &quot;:email_enc&quot;);
    if (!encrypted_data.empty()) {
        auto email_field = EncryptedField&lt;std::string&gt;::fromBase64(encrypted_data);
        return email_field.decrypt();
    }

    // Fallback to plaintext (for unmigrated users)
    return db-&gt;get(&quot;user:&quot; + user_id + &quot;:email_plain&quot;);
}
</code></pre>
<h3 id="phase-5-cleanup-week-6">Phase 5: Cleanup (Week 6+)<a class="headerlink" href="#phase-5-cleanup-week-6" title="Permanent link">&para;</a></h3>
<pre><code class="language-cpp">// After 100% migration confirmed, delete plaintext columns
void cleanupPlaintextData() {
    auto all_users = db-&gt;scan(&quot;user:&quot;);

    for (const auto&amp; [key, value] : all_users) {
        if (key.find(&quot;:email_plain&quot;) != std::string::npos ||
            key.find(&quot;:ssn_plain&quot;) != std::string::npos) {

            std::string user_id = extractUserId(key);

            // Verify encrypted version exists
            auto encrypted_flag = db-&gt;get(&quot;user:&quot; + user_id + &quot;:encrypted&quot;);
            if (encrypted_flag == &quot;true&quot;) {
                // Safe to delete plaintext
                db-&gt;del(key);
                std::cout &lt;&lt; &quot;Deleted plaintext: &quot; &lt;&lt; key &lt;&lt; std::endl;
            }
        }
    }
}
</code></pre>
<hr />
<h2 id="key-rotation-procedures">Key Rotation Procedures<a class="headerlink" href="#key-rotation-procedures" title="Permanent link">&para;</a></h2>
<h3 id="manual-rotation-process">Manual Rotation Process<a class="headerlink" href="#manual-rotation-process" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash">#!/bin/bash
# rotate-key.sh - Manual key rotation script

set -e

KEY_ID=$1
if [ -z &quot;$KEY_ID&quot; ]; then
  echo &quot;Usage: $0 &lt;key_id&gt;&quot;
  exit 1
fi

echo &quot;🔄 Starting key rotation for: $KEY_ID&quot;

# Step 1: Get current version
CURRENT=$(vault kv get -format=json themis/keys/$KEY_ID | jq -r '.data.metadata.version')
NEW_VERSION=$((CURRENT + 1))

echo &quot;📊 Current version: $CURRENT&quot;
echo &quot;📊 New version: $NEW_VERSION&quot;

# Step 2: Generate new key
NEW_KEY=$(openssl rand -base64 32)

# Step 3: Store new version in Vault
vault kv put themis/keys/$KEY_ID \
  key=&quot;$NEW_KEY&quot; \
  algorithm=&quot;AES-256-GCM&quot; \
  version=$NEW_VERSION \
  created_at=&quot;$(date -u +%Y-%m-%dT%H:%M:%SZ)&quot; \
  rotated_from=$CURRENT \
  rotation_reason=&quot;Scheduled rotation&quot;

echo &quot;✅ New key version created in Vault&quot;

# Step 4: Trigger application cache invalidation
curl -X POST https://themis-api.example.com/admin/cache/invalidate \
  -H &quot;Authorization: Bearer $ADMIN_TOKEN&quot; \
  -d &quot;{\&quot;key_id\&quot;: \&quot;$KEY_ID\&quot;}&quot;

echo &quot;✅ Application caches invalidated&quot;

# Step 5: Start background re-encryption
curl -X POST https://themis-api.example.com/admin/re-encrypt \
  -H &quot;Authorization: Bearer $ADMIN_TOKEN&quot; \
  -d &quot;{
    \&quot;key_id\&quot;: \&quot;$KEY_ID\&quot;,
    \&quot;source_version\&quot;: $CURRENT,
    \&quot;target_version\&quot;: $NEW_VERSION,
    \&quot;batch_size\&quot;: 1000
  }&quot;

echo &quot;✅ Re-encryption job started&quot;
echo &quot;🎉 Key rotation completed!&quot;
</code></pre>
<h3 id="re-encryption-job-implementation">Re-Encryption Job Implementation<a class="headerlink" href="#re-encryption-job-implementation" title="Permanent link">&para;</a></h3>
<pre><code class="language-cpp">// Background job to re-encrypt data with new key version
class ReEncryptionJob {
public:
    struct Config {
        std::string key_id;
        uint32_t source_version;
        uint32_t target_version;
        size_t batch_size = 1000;
        size_t parallelism = 4;
    };

    ReEncryptionJob(
        std::shared_ptr&lt;RocksDBWrapper&gt; db,
        std::shared_ptr&lt;FieldEncryption&gt; encryption,
        const Config&amp; config
    ) : db_(db), encryption_(encryption), config_(config) {}

    void run() {
        std::cout &lt;&lt; &quot;🔄 Starting re-encryption: &quot; &lt;&lt; config_.key_id 
                  &lt;&lt; &quot; v&quot; &lt;&lt; config_.source_version 
                  &lt;&lt; &quot; → v&quot; &lt;&lt; config_.target_version &lt;&lt; std::endl;

        auto start = std::chrono::steady_clock::now();
        size_t total_count = 0;
        size_t success_count = 0;

        // Scan all encrypted fields
        auto it = db_-&gt;newIterator();
        for (it-&gt;SeekToFirst(); it-&gt;Valid(); it-&gt;Next()) {
            std::string key = it-&gt;key().ToString();
            std::string value = it-&gt;value().ToString();

            try {
                // Parse encrypted blob
                json j = json::parse(value);

                for (auto&amp; [field_name, field_value] : j.items()) {
                    if (!field_value.is_string()) continue;

                    std::string blob_str = field_value.get&lt;std::string&gt;();

                    // Check if this field uses the key being rotated
                    if (blob_str.find(config_.key_id + &quot;:&quot;) == 0) {
                        auto blob = EncryptedBlob::fromBase64(blob_str);

                        if (blob.key_version == config_.source_version) {
                            // Decrypt with old key
                            std::string plaintext = encryption_-&gt;decryptToString(blob);

                            // Re-encrypt with new key
                            EncryptedField&lt;std::string&gt; new_field;
                            new_field.encrypt(plaintext, config_.key_id);

                            // Update JSON
                            j[field_name] = new_field.toBase64();

                            success_count++;
                        }
                    }
                }

                // Write updated record
                db_-&gt;put(key, j.dump());
                total_count++;

                if (total_count % 1000 == 0) {
                    std::cout &lt;&lt; &quot;Progress: &quot; &lt;&lt; total_count &lt;&lt; &quot; records processed, &quot;
                              &lt;&lt; success_count &lt;&lt; &quot; fields re-encrypted&quot; &lt;&lt; std::endl;
                }

            } catch (const std::exception&amp; e) {
                std::cerr &lt;&lt; &quot;Error processing key &quot; &lt;&lt; key &lt;&lt; &quot;: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;
            }
        }

        auto end = std::chrono::steady_clock::now();
        auto duration = std::chrono::duration_cast&lt;std::chrono::seconds&gt;(end - start).count();

        std::cout &lt;&lt; &quot;✅ Re-encryption completed:&quot; &lt;&lt; std::endl;
        std::cout &lt;&lt; &quot;   Records processed: &quot; &lt;&lt; total_count &lt;&lt; std::endl;
        std::cout &lt;&lt; &quot;   Fields re-encrypted: &quot; &lt;&lt; success_count &lt;&lt; std::endl;
        std::cout &lt;&lt; &quot;   Duration: &quot; &lt;&lt; duration &lt;&lt; &quot;s&quot; &lt;&lt; std::endl;
        std::cout &lt;&lt; &quot;   Throughput: &quot; &lt;&lt; (total_count / duration) &lt;&lt; &quot; records/sec&quot; &lt;&lt; std::endl;
    }

private:
    std::shared_ptr&lt;RocksDBWrapper&gt; db_;
    std::shared_ptr&lt;FieldEncryption&gt; encryption_;
    Config config_;
};
</code></pre>
<hr />
<h2 id="monitoring-alerting">Monitoring &amp; Alerting<a class="headerlink" href="#monitoring-alerting" title="Permanent link">&para;</a></h2>
<h3 id="key-metrics">Key Metrics<a class="headerlink" href="#key-metrics" title="Permanent link">&para;</a></h3>
<h4 id="application-metrics">Application Metrics<a class="headerlink" href="#application-metrics" title="Permanent link">&para;</a></h4>
<pre><code class="language-cpp">// Prometheus metrics (pseudocode)
class EncryptionMetrics {
public:
    // Counters
    prometheus::Counter encryption_operations;
    prometheus::Counter decryption_operations;
    prometheus::Counter encryption_errors;
    prometheus::Counter decryption_errors;

    // Histograms
    prometheus::Histogram encryption_duration_ms;
    prometheus::Histogram decryption_duration_ms;
    prometheus::Histogram vault_request_duration_ms;

    // Gauges
    prometheus::Gauge key_cache_size;
    prometheus::Gauge key_cache_hit_rate;
    prometheus::Gauge active_key_versions;
};

// Record metrics
void FieldEncryption::encrypt(const std::string&amp; plaintext, const std::string&amp; key_id) {
    auto start = std::chrono::steady_clock::now();

    try {
        // ... encryption logic ...

        metrics_.encryption_operations.Inc();

        auto duration = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(
            std::chrono::steady_clock::now() - start
        ).count();
        metrics_.encryption_duration_ms.Observe(duration);

    } catch (const std::exception&amp; e) {
        metrics_.encryption_errors.Inc();
        throw;
    }
}
</code></pre>
<h4 id="grafana-dashboard">Grafana Dashboard<a class="headerlink" href="#grafana-dashboard" title="Permanent link">&para;</a></h4>
<pre><code class="language-json">{
  &quot;dashboard&quot;: {
    &quot;title&quot;: &quot;Themis Encryption Metrics&quot;,
    &quot;panels&quot;: [
      {
        &quot;title&quot;: &quot;Encryption Operations/sec&quot;,
        &quot;targets&quot;: [
          {
            &quot;expr&quot;: &quot;rate(themis_encryption_operations_total[5m])&quot;
          }
        ]
      },
      {
        &quot;title&quot;: &quot;Decryption Latency (p95)&quot;,
        &quot;targets&quot;: [
          {
            &quot;expr&quot;: &quot;histogram_quantile(0.95, themis_decryption_duration_ms)&quot;
          }
        ]
      },
      {
        &quot;title&quot;: &quot;Cache Hit Rate&quot;,
        &quot;targets&quot;: [
          {
            &quot;expr&quot;: &quot;themis_key_cache_hit_rate&quot;
          }
        ]
      },
      {
        &quot;title&quot;: &quot;Vault Request Errors&quot;,
        &quot;targets&quot;: [
          {
            &quot;expr&quot;: &quot;rate(themis_vault_request_errors_total[5m])&quot;
          }
        ]
      }
    ]
  }
}
</code></pre>
<h3 id="alerting-rules">Alerting Rules<a class="headerlink" href="#alerting-rules" title="Permanent link">&para;</a></h3>
<pre><code class="language-yaml"># prometheus/alerts.yml
groups:
- name: encryption
  rules:

  # Alert if encryption failure rate &gt; 1%
  - alert: HighEncryptionErrorRate
    expr: |
      rate(themis_encryption_errors_total[5m]) / 
      rate(themis_encryption_operations_total[5m]) &gt; 0.01
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: &quot;High encryption error rate detected&quot;
      description: &quot;Encryption error rate is {{ $value | humanizePercentage }}&quot;

  # Alert if cache hit rate drops below 80%
  - alert: LowCacheHitRate
    expr: themis_key_cache_hit_rate &lt; 0.8
    for: 10m
    labels:
      severity: warning
    annotations:
      summary: &quot;Low key cache hit rate&quot;
      description: &quot;Cache hit rate is {{ $value | humanizePercentage }}&quot;

  # Alert if Vault requests are slow
  - alert: SlowVaultRequests
    expr: |
      histogram_quantile(0.95, 
        rate(themis_vault_request_duration_ms_bucket[5m])
      ) &gt; 100
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: &quot;Slow Vault API requests&quot;
      description: &quot;P95 latency is {{ $value }}ms&quot;

  # Alert if a key rotation is overdue
  - alert: KeyRotationOverdue
    expr: |
      (time() - themis_key_last_rotation_timestamp) / 86400 &gt; 180
    for: 1d
    labels:
      severity: warning
    annotations:
      summary: &quot;Key rotation overdue&quot;
      description: &quot;Key {{ $labels.key_id }} has not been rotated in {{ $value }} days&quot;
</code></pre>
<hr />
<h2 id="disaster-recovery">Disaster Recovery<a class="headerlink" href="#disaster-recovery" title="Permanent link">&para;</a></h2>
<h3 id="backup-procedures">Backup Procedures<a class="headerlink" href="#backup-procedures" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash">#!/bin/bash
# backup-vault.sh - Automated Vault backup

BACKUP_DIR=&quot;/backups/vault/$(date +%Y%m%d)&quot;
mkdir -p $BACKUP_DIR

# Take Consul snapshot (Vault storage backend)
consul snapshot save $BACKUP_DIR/consul-snapshot.snap

# Export all encryption keys (encrypted with GPG)
vault kv get -format=json themis/keys | \
  gpg --encrypt --recipient backup@example.com &gt; \
  $BACKUP_DIR/encryption-keys.json.gpg

# Backup Vault unseal keys (should be in separate secure location)
# These should already be distributed to key custodians

# Upload to S3 with server-side encryption
aws s3 cp $BACKUP_DIR s3://vault-backups/$(date +%Y%m%d)/ \
  --recursive \
  --sse AES256

echo &quot;✅ Vault backup completed: $BACKUP_DIR&quot;
</code></pre>
<h3 id="recovery-procedures">Recovery Procedures<a class="headerlink" href="#recovery-procedures" title="Permanent link">&para;</a></h3>
<h4 id="scenario-1-lost-vault-token">Scenario 1: Lost Vault Token<a class="headerlink" href="#scenario-1-lost-vault-token" title="Permanent link">&para;</a></h4>
<pre><code class="language-bash"># Generate new token from AppRole
ROLE_ID=&quot;&lt;stored-role-id&gt;&quot;
SECRET_ID=$(vault write -f auth/approle/role/themis-app/secret-id | \
  grep 'secret_id ' | awk '{print $2}')

NEW_TOKEN=$(vault write auth/approle/login \
  role_id=$ROLE_ID \
  secret_id=$SECRET_ID | \
  grep 'token ' | awk '{print $2}')

# Update application configuration
kubectl set env deployment/themis-api VAULT_TOKEN=$NEW_TOKEN
</code></pre>
<h4 id="scenario-2-vault-cluster-failure">Scenario 2: Vault Cluster Failure<a class="headerlink" href="#scenario-2-vault-cluster-failure" title="Permanent link">&para;</a></h4>
<pre><code class="language-bash"># Restore from backup
consul snapshot restore /backups/vault/20251030/consul-snapshot.snap

# Unseal all Vault nodes
for NODE in vault-1 vault-2 vault-3; do
  vault operator unseal -address=https://$NODE:8200 &lt;unseal-key-1&gt;
  vault operator unseal -address=https://$NODE:8200 &lt;unseal-key-2&gt;
  vault operator unseal -address=https://$NODE:8200 &lt;unseal-key-3&gt;
done

# Verify key recovery
vault kv get themis/keys/user_pii
</code></pre>
<h4 id="scenario-3-corrupted-encryption-key">Scenario 3: Corrupted Encryption Key<a class="headerlink" href="#scenario-3-corrupted-encryption-key" title="Permanent link">&para;</a></h4>
<pre><code class="language-bash"># If a key becomes corrupted, restore from backup
gpg --decrypt /backups/vault/20251030/encryption-keys.json.gpg | \
  jq '.data.keys.user_pii' | \
  vault kv put themis/keys/user_pii -

# Verify
vault kv get themis/keys/user_pii
</code></pre>
<hr />
<h2 id="security-best-practices">Security Best Practices<a class="headerlink" href="#security-best-practices" title="Permanent link">&para;</a></h2>
<h3 id="1-key-storage">1. Key Storage<a class="headerlink" href="#1-key-storage" title="Permanent link">&para;</a></h3>
<p>✅ <strong>DO:</strong>
- Store keys in HashiCorp Vault with encryption at rest
- Use hardware security modules (HSM) for Vault master key
- Implement key versioning for rotation
- Distribute unseal keys to 3+ trusted individuals
- Audit all key access via Vault audit logs</p>
<p>❌ <strong>DON'T:</strong>
- Store keys in environment variables or config files
- Commit keys to version control
- Share keys via email/Slack
- Use single-version keys (prevents rotation)</p>
<h3 id="2-access-control">2. Access Control<a class="headerlink" href="#2-access-control" title="Permanent link">&para;</a></h3>
<pre><code class="language-hcl"># Principle of least privilege
path &quot;themis/data/keys/user_pii&quot; {
  capabilities = [&quot;read&quot;]

  # Allow only from specific IP range
  allowed_parameters = {
    &quot;cidr_list&quot; = [&quot;10.0.0.0/8&quot;]
  }
}

# Separate admin policy for key rotation
path &quot;themis/data/keys/*&quot; {
  capabilities = [&quot;create&quot;, &quot;update&quot;, &quot;delete&quot;]

  # Require MFA for destructive operations
  mfa_methods = [&quot;totp&quot;]
}
</code></pre>
<h3 id="3-network-security">3. Network Security<a class="headerlink" href="#3-network-security" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>TLS 1.3</strong> for all Vault communications</li>
<li><strong>Mutual TLS</strong> (mTLS) in production</li>
<li><strong>Network policies</strong> to restrict Vault access</li>
<li><strong>Private subnets</strong> for Vault cluster</li>
</ul>
<h3 id="4-audit-logging">4. Audit Logging<a class="headerlink" href="#4-audit-logging" title="Permanent link">&para;</a></h3>
<pre><code class="language-hcl"># vault/config/audit.hcl
audit {
  type = &quot;file&quot;

  options = {
    file_path = &quot;/vault/logs/audit.log&quot;
    log_raw = false  # Don't log sensitive data
    hmac_accessor = true
    mode = &quot;0600&quot;
    format = &quot;json&quot;
  }
}
</code></pre>
<h3 id="5-monitoring">5. Monitoring<a class="headerlink" href="#5-monitoring" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Alert on failed authentication</strong> attempts</li>
<li><strong>Monitor key access patterns</strong> for anomalies</li>
<li><strong>Track cache hit rates</strong> (should be &gt;80%)</li>
<li><strong>Set up dead man's switch</strong> for unseal keys</li>
</ul>
<hr />
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="issue-slow-encryption-performance">Issue: Slow Encryption Performance<a class="headerlink" href="#issue-slow-encryption-performance" title="Permanent link">&para;</a></h3>
<p><strong>Symptoms:</strong>
- Encryption operations &gt;10ms
- High CPU usage
- Low throughput</p>
<p><strong>Diagnosis:</strong></p>
<pre><code class="language-bash"># Check if AES-NI is enabled
lscpu | grep aes
# Should show &quot;aes&quot; in flags

# Check OpenSSL version
openssl version
# Should be 3.0+

# Profile encryption calls
perf record -g ./themis_demo_encryption
perf report
</code></pre>
<p><strong>Solutions:</strong>
1. Verify AES-NI hardware support
2. Update OpenSSL to latest version
3. Increase key cache size
4. Use connection pooling for Vault requests</p>
<hr />
<h3 id="issue-vault-connection-timeouts">Issue: Vault Connection Timeouts<a class="headerlink" href="#issue-vault-connection-timeouts" title="Permanent link">&para;</a></h3>
<p><strong>Symptoms:</strong>
- <code>CURL error: Timeout was reached</code>
- Intermittent decryption failures</p>
<p><strong>Diagnosis:</strong></p>
<pre><code class="language-bash"># Test Vault connectivity
time curl -k https://vault.example.com:8200/v1/sys/health

# Check network latency
ping -c 10 vault.example.com

# Review Vault server logs
vault audit log | grep themis
</code></pre>
<p><strong>Solutions:</strong>
1. Increase <code>request_timeout_ms</code> in config
2. Deploy Vault closer to application (same datacenter)
3. Enable HTTP/2 keep-alive
4. Scale Vault cluster horizontally</p>
<hr />
<h3 id="issue-cache-thrashing">Issue: Cache Thrashing<a class="headerlink" href="#issue-cache-thrashing" title="Permanent link">&para;</a></h3>
<p><strong>Symptoms:</strong>
- Cache hit rate &lt;50%
- Frequent Vault API calls
- Increased latency</p>
<p><strong>Diagnosis:</strong></p>
<pre><code class="language-cpp">// Enable debug logging
auto stats = vault_provider-&gt;getCacheStats();
std::cout &lt;&lt; &quot;Hit rate: &quot; &lt;&lt; stats.hit_rate &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;Total requests: &quot; &lt;&lt; stats.total_requests &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;Cache size: &quot; &lt;&lt; stats.cache_size &lt;&lt; std::endl;
</code></pre>
<p><strong>Solutions:</strong>
1. Increase <code>cache_capacity</code> (default: 1000)
2. Increase <code>cache_ttl_seconds</code> (default: 3600)
3. Pre-warm cache on application startup
4. Review key access patterns (consolidate similar keys)</p>
<hr />
<h2 id="performance-tuning">Performance Tuning<a class="headerlink" href="#performance-tuning" title="Permanent link">&para;</a></h2>
<h3 id="benchmark-results">Benchmark Results<a class="headerlink" href="#benchmark-results" title="Permanent link">&para;</a></h3>
<p><strong>Hardware:</strong> Intel Xeon 8375C (AES-NI), 16GB RAM, NVMe SSD</p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Throughput</th>
<th>Latency (p50)</th>
<th>Latency (p95)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Encrypt (cached key)</td>
<td>256,000 ops/sec</td>
<td>0.004 ms</td>
<td>0.008 ms</td>
</tr>
<tr>
<td>Decrypt (cached key)</td>
<td>200,000 ops/sec</td>
<td>0.005 ms</td>
<td>0.010 ms</td>
</tr>
<tr>
<td>Vault key fetch (cold)</td>
<td>20 ops/sec</td>
<td>50 ms</td>
<td>100 ms</td>
</tr>
<tr>
<td>DB write (encrypted)</td>
<td>1,300 ops/sec</td>
<td>0.75 ms</td>
<td>2 ms</td>
</tr>
</tbody>
</table>
<h3 id="optimization-checklist">Optimization Checklist<a class="headerlink" href="#optimization-checklist" title="Permanent link">&para;</a></h3>
<ul>
<li>[x] <strong>Enable AES-NI</strong> hardware acceleration</li>
<li>[x] <strong>Cache keys</strong> in memory (1h TTL)</li>
<li>[x] <strong>Use connection pooling</strong> for Vault</li>
<li>[x] <strong>Batch operations</strong> where possible</li>
<li>[x] <strong>Pre-warm cache</strong> on startup</li>
<li>[ ] <strong>Implement circuit breaker</strong> for Vault failures</li>
<li>[ ] <strong>Use Vault agent</strong> for local caching</li>
<li>[ ] <strong>Deploy Vault replicas</strong> in each datacenter</li>
</ul>
<hr />
<h2 id="appendix">Appendix<a class="headerlink" href="#appendix" title="Permanent link">&para;</a></h2>
<h3 id="a-key-rotation-checklist">A. Key Rotation Checklist<a class="headerlink" href="#a-key-rotation-checklist" title="Permanent link">&para;</a></h3>
<pre><code>□ Generate new key version in Vault
□ Invalidate application key caches
□ Start background re-encryption job
□ Monitor re-encryption progress
□ Verify 100% migration to new version
□ Mark old key version as DEPRECATED
□ Wait 90-day grace period
□ Delete old key version from Vault
□ Update audit logs
</code></pre>
<h3 id="b-emergency-contacts">B. Emergency Contacts<a class="headerlink" href="#b-emergency-contacts" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Role</th>
<th>Name</th>
<th>Contact</th>
<th>Responsibility</th>
</tr>
</thead>
<tbody>
<tr>
<td>Security Lead</td>
<td>Alice Johnson</td>
<td>alice@example.com</td>
<td>Key management approval</td>
</tr>
<tr>
<td>DevOps Lead</td>
<td>Bob Smith</td>
<td>bob@example.com</td>
<td>Vault infrastructure</td>
</tr>
<tr>
<td>On-Call Engineer</td>
<td><rotation></td>
<td>oncall@example.com</td>
<td>24/7 incident response</td>
</tr>
</tbody>
</table>
<h3 id="c-compliance-matrix">C. Compliance Matrix<a class="headerlink" href="#c-compliance-matrix" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Implementation</th>
<th>Evidence</th>
</tr>
</thead>
<tbody>
<tr>
<td>GDPR Art. 32</td>
<td>AES-256-GCM encryption</td>
<td>Vault audit logs</td>
</tr>
<tr>
<td>HIPAA §164.312(a)(2)(iv)</td>
<td>Key versioning + rotation</td>
<td>Rotation schedule</td>
</tr>
<tr>
<td>PCI DSS 3.4</td>
<td>Cryptographic key management</td>
<td>Vault policies</td>
</tr>
<tr>
<td>SOC 2 CC6.1</td>
<td>Access controls</td>
<td>Vault AppRole logs</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Document Version:</strong> 1.0<br />
<strong>Last Review:</strong> 30. Oktober 2025<br />
<strong>Next Review:</strong> 30. Januar 2026<br />
<strong>Owner:</strong> Security Engineering Team</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.instant", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version": "Version ausw\u00e4hlen"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>